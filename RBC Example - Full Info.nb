(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     75478,       1934]
NotebookOptionsPosition[     68386,       1800]
NotebookOutlinePosition[     68728,       1815]
CellTagsIndexPosition[     68685,       1812]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Clear Workspace", "Subsection",
 CellChangeTimes->{{3.465644519984375*^9, 3.465644520671875*^9}, {
  3.5824075291179495`*^9, 
  3.5824075314267535`*^9}},ExpressionUUID->"30d303cc-e8c2-46a4-b231-\
b754466180d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4628993695007*^9, 3.4628993711507*^9}, {
  3.4628995236937*^9, 3.4628995417777*^9}, {3.4629012084867*^9, 
  3.4629012144207*^9}, {3.4629012669617*^9, 3.4629012747977*^9}, {
  3.4629013846857*^9, 3.4629013853077*^9}, {3.4741254201057*^9, 
  3.4741254219427*^9}, {3.6286038941019564`*^9, 
  3.628603894301956*^9}},ExpressionUUID->"830b0594-5990-4ed9-946f-\
09c5d74899b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["System", "Subsection",
 CellChangeTimes->{{3.632763129680771*^9, 
  3.6327631374517813`*^9}},ExpressionUUID->"aae23253-ce10-4142-8ccc-\
3a56e12d63e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Beta]", "*", 
     SuperscriptBox[
      RowBox[{"Exp", "[", "z", "]"}], 
      FractionBox["1", 
       RowBox[{"\[Alpha]", "-", "1"}]]], "*", 
     FractionBox[
      RowBox[{"Exp", "[", "c", "]"}], 
      RowBox[{"Exp", "[", "cp", "]"}]], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", "*", 
        RowBox[{"Exp", "[", "zp", "]"}], "*", 
        SuperscriptBox[
         RowBox[{"Exp", "[", "k", "]"}], 
         RowBox[{"\[Alpha]", "-", "1"}]]}], "+", "1", "-", "\[Delta]"}], 
      ")"}]}], "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "z", "]"}], "*", 
     SuperscriptBox[
      RowBox[{"Exp", "[", "klag", "]"}], "\[Alpha]"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Delta]"}], ")"}], "*", 
     RowBox[{"Exp", "[", "klag", "]"}]}], "-", 
    RowBox[{"Exp", "[", "c", "]"}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Exp", "[", "z", "]"}], 
      FractionBox["1", 
       RowBox[{"1", "-", "\[Alpha]"}]]], "*", 
     RowBox[{"Exp", "[", "k", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Mu]", "[", "s", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Sigma]", "[", "s", "]"}], "*", "\[Epsilon]"}], "-", "z"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "4", "]"}], "]"}], "=", "\[Eta]1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "=", "\[Eta]2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"f", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.632763139911785*^9, 3.632763409024165*^9}, {
   3.6327634402962093`*^9, 3.6327634419062114`*^9}, {3.6327664440591516`*^9, 
   3.632766444839153*^9}, {3.6327676791798964`*^9, 3.632767681219899*^9}, {
   3.6327677574030113`*^9, 3.6327677804430475`*^9}, {3.6327726542625003`*^9, 
   3.632772658667569*^9}, {3.6328297185501204`*^9, 3.6328297708812294`*^9}, {
   3.633298914164136*^9, 3.6332991251433735`*^9}, 3.6332992427930613`*^9, {
   3.633299334765042*^9, 3.6332993427150974`*^9}, {3.633299524691136*^9, 
   3.633299524756137*^9}, {3.6333504878910327`*^9, 3.6333507116743574`*^9}, {
   3.6339590973043876`*^9, 3.6339591617995176`*^9}, {3.6339600287766294`*^9, 
   3.633960029624631*^9}, {3.634304324730209*^9, 3.63430433664089*^9}, {
   3.6343048735175977`*^9, 3.634304896892935*^9}, {3.6400239391047254`*^9, 
   3.64002403073792*^9}, {3.640024173816264*^9, 3.6400241776392965`*^9}, {
   3.6400247281986437`*^9, 3.6400247327086544`*^9}, {3.6430294554406023`*^9, 
   3.6430295144869795`*^9}, {3.643029655781061*^9, 3.6430296571091375`*^9}, {
   3.6430296940702515`*^9, 3.6430296953333235`*^9}, {3.645543254814271*^9, 
   3.645543288378323*^9}, {3.6712954033020763`*^9, 3.6712954323831725`*^9}, {
   3.7008338528626432`*^9, 3.7008338640087547`*^9}, {3.7008339760251503`*^9, 
   3.7008339782219973`*^9}, 3.7187936082566805`*^9, 
   3.723914296730157*^9},ExpressionUUID->"725c185d-e996-47cc-a4f8-\
e4ab8f860ea0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables Definitions", "Subsection",
 CellChangeTimes->{{3.5359999768587947`*^9, 3.5359999836951857`*^9}, {
   3.5764996882111*^9, 3.576499694551109*^9}, 
   3.5765000569766483`*^9},ExpressionUUID->"d4741a9d-9ae7-4d01-978a-\
d9c071b274f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Non", "-", 
    RowBox[{"Predetermined", " ", "Variables"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"yvarsp", "=", 
     RowBox[{"{", 
      RowBox[{"cp", ",", "zp"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yvars", "=", 
     RowBox[{"{", 
      RowBox[{"c", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yfuns", "=", 
     RowBox[{"{", 
      RowBox[{"cfun", ",", "zfun"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yvarss", "=", 
     RowBox[{"{", 
      RowBox[{"css", ",", "zss"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yvarssval", "=", 
     RowBox[{"{", 
      RowBox[{"cssval", ",", "zssval"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Predetermined", " ", "Variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xvars", "=", 
     RowBox[{"{", 
      RowBox[{"k", ",", "\[Eta]1", ",", "\[Eta]2"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xlag", "=", 
     RowBox[{"{", 
      RowBox[{"klag", ",", "\[Eta]1lag", ",", "\[Eta]2lag"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xfuns", "=", 
     RowBox[{"{", 
      RowBox[{"kfun", ",", "\[Eta]1fun", ",", "\[Eta]2fun"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xvarss", "=", 
     RowBox[{"{", 
      RowBox[{"kss", ",", "\[Eta]1ss", ",", "\[Eta]2ss"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xvarssval", "=", 
     RowBox[{"{", 
      RowBox[{"kssval", ",", "\[Eta]1ssval", ",", "\[Eta]2ssval"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Shocks", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"epsp", "=", 
     RowBox[{"{", "\[Epsilon]p", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eps", "=", 
     RowBox[{"{", "\[Epsilon]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Markov", " ", "Switching", " ", "Variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tvarsp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "sp", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "sp", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tvars", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "s", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "s", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tvarspss", "=", 
     RowBox[{"{", 
      RowBox[{"\[Mu]bar", ",", 
       RowBox[{"\[Sigma]", "[", "sp", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tvarss", "=", 
     RowBox[{"{", 
      RowBox[{"\[Mu]bar", ",", 
       RowBox[{"\[Sigma]", "[", "s", "]"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.576499891656398*^9, 3.576500003176573*^9}, 
   3.5765000569766483`*^9, 3.5765010194101195`*^9, {3.5765046809617567`*^9, 
   3.576504682121758*^9}, {3.576505456151792*^9, 3.576505486654341*^9}, {
   3.576505553684455*^9, 3.5765055765644875`*^9}, {3.577038045760437*^9, 
   3.57703804827044*^9}, {3.577038139390568*^9, 3.5770381398805685`*^9}, {
   3.5770381817031283`*^9, 3.57703820063067*^9}, {3.5771221501422386`*^9, 
   3.577122169992266*^9}, {3.5934379905838156`*^9, 3.5934380846441956`*^9}, {
   3.5934381294377575`*^9, 3.5934381663738704`*^9}, {3.6040805687078896`*^9, 
   3.6040805691239133`*^9}, {3.604080613979479*^9, 3.604080683947481*^9}, {
   3.6077044932731476`*^9, 3.6077044972333746`*^9}, {3.607704544801095*^9, 
   3.6077045458971577`*^9}, {3.60770462461666*^9, 3.607704626976795*^9}, {
   3.607704661953796*^9, 3.6077046936876106`*^9}, {3.607705056756377*^9, 
   3.6077050638777847`*^9}, {3.6077211525189705`*^9, 3.607721174510228*^9}, {
   3.607773489859482*^9, 3.6077735036432705`*^9}, 3.607773585332943*^9, {
   3.6077752027444534`*^9, 3.607775260806774*^9}, {3.6077766029545407`*^9, 
   3.607776607186783*^9}, {3.6077767651778193`*^9, 3.6077767967856274`*^9}, {
   3.6077768444493537`*^9, 3.6077768681207075`*^9}, {3.60777731592632*^9, 
   3.6077773416457915`*^9}, {3.6077776089160786`*^9, 3.6077776591159496`*^9}, 
   3.6077776926988707`*^9, {3.60777846266191*^9, 3.607778470741372*^9}, {
   3.607778508101509*^9, 3.607778509309578*^9}, {3.607778565733805*^9, 
   3.6077785774854774`*^9}, {3.6077867237944193`*^9, 3.607786726401569*^9}, {
   3.6077871008079834`*^9, 3.6077871086954346`*^9}, {3.6078067908649845`*^9, 
   3.6078068103671*^9}, {3.6084116395280347`*^9, 3.608411686778101*^9}, {
   3.608413510674198*^9, 3.608413516719544*^9}, {3.608413589000678*^9, 
   3.6084135893646994`*^9}, {3.6084866794383907`*^9, 
   3.6084866998865595`*^9}, {3.608486776685952*^9, 3.6084867866375217`*^9}, {
   3.6084868564995174`*^9, 3.6084869000850105`*^9}, {3.608486996812543*^9, 
   3.6084870065881023`*^9}, {3.6084870431911955`*^9, 3.608487046492385*^9}, {
   3.608554394570922*^9, 3.6085544121769295`*^9}, {3.6085551476439953`*^9, 
   3.608555156026475*^9}, {3.608555322769012*^9, 3.608555326337216*^9}, {
   3.6088357607233095`*^9, 3.6088357801484203`*^9}, {3.6088359220185347`*^9, 
   3.6088359427877226`*^9}, {3.6088364081131315`*^9, 
   3.6088364387798853`*^9}, {3.6088982053791666`*^9, 
   3.6088982132356167`*^9}, {3.6088982657796216`*^9, 3.608898282555581*^9}, {
   3.6089968428728323`*^9, 3.608996862840975*^9}, {3.609007700201022*^9, 
   3.609007719624133*^9}, {3.609601719826563*^9, 3.609601834106099*^9}, {
   3.609601890882346*^9, 3.609601896784684*^9}, {3.6096019967584023`*^9, 
   3.609601998277489*^9}, {3.6096020708296385`*^9, 3.6096020870315657`*^9}, {
   3.609676892482709*^9, 3.6096769198427477`*^9}, {3.6096787703621616`*^9, 
   3.6096788251692953`*^9}, {3.609678950221447*^9, 3.6096789547647066`*^9}, {
   3.6100272677384396`*^9, 3.6100272677384396`*^9}, {3.610027357498565*^9, 
   3.610027357508565*^9}, {3.6265493239258213`*^9, 3.6265493239768214`*^9}, {
   3.6265493559178886`*^9, 3.6265493559578886`*^9}, {3.626550403339673*^9, 
   3.626550403369673*^9}, {3.626550520301965*^9, 3.6265505203719654`*^9}, {
   3.6265510135511875`*^9, 3.626551013661187*^9}, {3.6265518651792955`*^9, 
   3.626551866711298*^9}, {3.6339591815775614`*^9, 3.6339592591247764`*^9}, {
   3.633960032430638*^9, 3.6339600369606466`*^9}, {3.634305353602057*^9, 
   3.6343053710410547`*^9}, {3.63431182094809*^9, 3.6343118266034136`*^9}, {
   3.6343118754882216`*^9, 3.6343118756782217`*^9}, {3.6400240333249264`*^9, 
   3.640024048044963*^9}, {3.6430296601753125`*^9, 3.643029714005391*^9}, {
   3.6430297669654207`*^9, 3.6430297710366535`*^9}, {3.6455432905203257`*^9, 
   3.6455433401844025`*^9}, {3.700833997221676*^9, 3.700834014259493*^9}, {
   3.700834095896045*^9, 
   3.7008341259169593`*^9}},ExpressionUUID->"02f26ce0-4ce4-4485-ad87-\
a86389b96c50"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.549388834060892*^9, 
  3.5493888351169524`*^9}},ExpressionUUID->"1708d7ce-b0de-480a-9004-\
7ee0b5d7398a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "States"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"state", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xlag", ",", "eps", ",", "\[Chi]"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statep", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xvars", ",", 
        RowBox[{"\[Chi]", "*", "epsp"}], ",", "\[Chi]"}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Function", " ", "Lists"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yfunlist", "=", 
     RowBox[{"Through", "[", 
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"yfuns", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", "__", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xfunlist", "=", 
     RowBox[{"Through", "[", 
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"xfuns", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", "__", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Define", " ", "Functions"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funrulei", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"yvars", "\[Rule]", 
          RowBox[{"Through", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"yfuns", ",", 
                RowBox[{"{", "s", "}"}]}], "]"}], "]"}], ",", "state"}], 
            "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Thread", "[", 
         RowBox[{"xvars", "\[Rule]", 
          RowBox[{"Through", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"xfuns", ",", 
                RowBox[{"{", "s", "}"}]}], "]"}], "]"}], ",", "state"}], 
            "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Thread", "[", 
         RowBox[{"tvars", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"tvarss", "+", 
            RowBox[{"\[Chi]", "*", 
             RowBox[{"(", 
              RowBox[{"tvars", "-", "tvarss"}], ")"}]}]}], ")"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funrulej", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"yvarsp", "\[Rule]", 
          RowBox[{"Through", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"yfuns", ",", 
                RowBox[{"{", "sp", "}"}]}], "]"}], "]"}], ",", "statep"}], 
            "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Thread", "[", 
         RowBox[{"tvarsp", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"tvarspss", "+", 
            RowBox[{"\[Chi]", "*", 
             RowBox[{"(", 
              RowBox[{"tvarsp", "-", "tvarspss"}], ")"}]}]}], ")"}]}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6084090394914484`*^9, 3.6084090522741795`*^9}, {
   3.608410282801562*^9, 3.608410289635953*^9}, {3.608410332476403*^9, 
   3.6084103480282927`*^9}, {3.6084104946836805`*^9, 
   3.6084105195771046`*^9}, {3.6084108166840982`*^9, 
   3.6084108292958193`*^9}, {3.608410974673135*^9, 3.6084110247079964`*^9}, 
   3.6084110789821005`*^9, {3.608411244063543*^9, 3.6084112820497155`*^9}, {
   3.6084116574180593`*^9, 3.6084117409481764`*^9}, 3.6084134930631914`*^9, {
   3.6084136175463114`*^9, 3.608413646495967*^9}, {3.608413823115069*^9, 
   3.608413876134102*^9}, {3.6084144921143336`*^9, 3.60841449536652*^9}, {
   3.6084153345345173`*^9, 3.6084153437640452`*^9}, {3.6096770800670266`*^9, 
   3.609677081567029*^9}, {3.6339592950638523`*^9, 3.633959368153034*^9}, {
   3.6343117635808086`*^9, 3.6343118039411173`*^9}, {3.634311866075207*^9, 
   3.6343118981322536`*^9}},ExpressionUUID->"7abe376f-f799-4387-8bd4-\
48fc44948f94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ns", "=", "2"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "regimes"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ny", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "yvars", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nx", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "xvars", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ne", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "eps", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nt", "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "tvars", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", ":", " ", 
    RowBox[{"Should", " ", "Print", " ", "Zero"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"n", "-", "nx", "-", "ny"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5765000246866026`*^9, 3.5765001227917614`*^9}, {
   3.5768514957931385`*^9, 3.576851496203139*^9}, {3.5771223086224604`*^9, 
   3.5771223295924892`*^9}, {3.5771224365226393`*^9, 3.5771224444326506`*^9}, 
   3.5771225507327995`*^9, 3.593438172860241*^9, 3.609601880430749*^9, {
   3.6096021622458677`*^9, 3.6096021633329296`*^9}, 3.6096794740684047`*^9, 
   3.6339593485029945`*^9},ExpressionUUID->"993ff909-8db2-4c81-88d4-\
71a19a8d8f2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regimes", "Subsection",
 CellChangeTimes->{{3.5496299986305246`*^9, 3.549629999468572*^9}, 
   3.5765000569766483`*^9, {3.6040814085299244`*^9, 
   3.6040814097769957`*^9}},ExpressionUUID->"c53bbeac-3dea-433b-8d61-\
0f28bfb2a437"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pmat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ns"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "ns"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"probrule", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Flatten", "[", "Pmat", "]"}], ")"}], "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"p11", ",", 
       RowBox[{"1", "-", "p11"}], ",", 
       RowBox[{"1", "-", "p22"}], ",", "p22"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pmat", "=", 
   RowBox[{"Pmat", "/.", "probrule"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.549630010509204*^9, 3.5496300980422106`*^9}, {
   3.5496302840118475`*^9, 3.549630286545992*^9}, {3.5496313149698143`*^9, 
   3.5496313164088964`*^9}, {3.549631569783389*^9, 3.54963157207952*^9}, {
   3.5496429523946824`*^9, 3.549643002473547*^9}, {3.549646264415119*^9, 
   3.549646335724198*^9}, 3.549646849827603*^9, {3.5497134558872995`*^9, 
   3.54971345606631*^9}, {3.5497137131240125`*^9, 3.549713714351083*^9}, {
   3.549713757885573*^9, 3.5497138258924627`*^9}, {3.5497139251901417`*^9, 
   3.549713926173198*^9}, {3.549714123920509*^9, 3.5497141259316235`*^9}, {
   3.560033131401148*^9, 3.5600331348043427`*^9}, {3.5600333073432117`*^9, 
   3.560033310620399*^9}, 3.5765000569766483`*^9, {3.576500129841771*^9, 
   3.5765001913218575`*^9}, {3.5772726286460094`*^9, 
   3.5772726361160192`*^9}, {3.5934424472293*^9, 3.593442461724129*^9}, 
   3.6096019553830357`*^9, {3.6096042959431562`*^9, 3.6096043322552333`*^9}, 
   3.6096043705514235`*^9, {3.6096044016452017`*^9, 3.609604405539425*^9}, {
   3.626550520381965*^9, 3.626550520391965*^9}, {3.6265510136711874`*^9, 
   3.626551013681187*^9}, {3.6272359473638573`*^9, 3.6272359549738717`*^9}, {
   3.6272360328130713`*^9, 3.6272360392390842`*^9}, {3.633959385756074*^9, 
   3.633959428885186*^9}},ExpressionUUID->"b59aba1d-ff20-477c-9a2e-\
d45d96ffd18a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"F", ",", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Pmat", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "j"}], "]"}], "]"}], "*", "f"}], "/.", 
               "funrulej"}], "/.", "funrulei"}], "/.", 
             RowBox[{"sp", "\[Rule]", "j"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "ns"}], "}"}]}], "]"}], "/.", 
          RowBox[{"s", "\[Rule]", "ii"}]}]}], "}"}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.608414307009746*^9, 3.608414422526353*^9}, {
   3.608414507812231*^9, 3.608414507941239*^9}, {3.608414600592538*^9, 
   3.6084146025746517`*^9}, {3.609601962639451*^9, 3.6096019674867277`*^9}, {
   3.6097758642534857`*^9, 3.6097759138283205`*^9}, 3.6097760476919775`*^9, {
   3.6098539300319843`*^9, 3.6098539309420366`*^9}, {3.6272276167742467`*^9, 
   3.627227735876416*^9}, {3.6272323795087004`*^9, 3.6272323816587048`*^9}, {
   3.6272324510938964`*^9, 3.627232451713897*^9}, {3.633959355430009*^9, 
   3.6339593828260665`*^9}, {3.633959438415208*^9, 
   3.633959443891219*^9}},ExpressionUUID->"77f2f6d4-996e-4645-944e-\
7f27bed2c954"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Steady State", "Section",
 CellChangeTimes->{{3.6339594897533135`*^9, 
  3.6339594911303167`*^9}},ExpressionUUID->"af7a2dbd-5680-45c4-a0d1-\
c6467d82a1e2"],

Cell[CellGroupData[{

Cell["Analytic Steady State", "Subsection",
 CellChangeTimes->{{3.6339595327294025`*^9, 
  3.6339595363294096`*^9}},ExpressionUUID->"359715db-236d-4307-9aa9-\
31b7f654da35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zssval", "=", "\[Mu]bar"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kssval", "=", 
   RowBox[{"Log", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"\[Alpha]", "*", 
         RowBox[{"Exp", "[", "\[Mu]bar", "]"}]}]], "*", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"\[Beta]", "*", 
           SuperscriptBox[
            RowBox[{"Exp", "[", "\[Mu]bar", "]"}], 
            FractionBox["1", 
             RowBox[{"\[Alpha]", "-", "1"}]]]}]], "-", "1", "+", "\[Delta]"}],
         ")"}]}], ")"}], 
     FractionBox["1", 
      RowBox[{"\[Alpha]", "-", "1"}]]], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cssval", "=", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", "\[Mu]bar", "]"}], "*", 
      SuperscriptBox[
       RowBox[{"Exp", "[", "kssval", "]"}], "\[Alpha]"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Delta]", "-", 
        SuperscriptBox[
         RowBox[{"Exp", "[", "\[Mu]bar", "]"}], 
         FractionBox["1", 
          RowBox[{"1", "-", "\[Alpha]"}]]]}], ")"}], "*", 
      RowBox[{"Exp", "[", "kssval", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]1ssval", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]2ssval", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.633959541539445*^9, 3.633959565429519*^9}, {
   3.634304341417163*^9, 3.6343043424962254`*^9}, {3.634304880693008*^9, 
   3.6343049004201365`*^9}, {3.640024054736983*^9, 3.640024121005145*^9}, 
   3.6400241559462233`*^9, {3.6400242100343723`*^9, 3.6400242116423764`*^9}, {
   3.6430297268311253`*^9, 3.643029756148802*^9}, {3.6712954377191906`*^9, 
   3.6712954687112923`*^9}, {3.7008338687523766`*^9, 3.700833874586914*^9}, 
   3.71879362413409*^9},ExpressionUUID->"2a5a472c-f850-462a-af6c-\
de1814e55a26"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.6339596564007053`*^9, 
  3.633959657717708*^9}},ExpressionUUID->"625815a2-c2e6-4dad-8818-\
bc68f291dcde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parmrule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "\[Rule]", "0.99722"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "\[Rule]", "0.28"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", "\[Rule]", "0.025"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]bar", "\[Rule]", 
      FractionBox["1.3277", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]bar", "\[Rule]", 
      FractionBox["3.1448", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"p11", "\[Rule]", "0.98"}], ",", "\[IndentingNewLine]", 
     RowBox[{"p22", "\[Rule]", "0.98"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "1", "]"}], "\[Rule]", 
      FractionBox["0.712011", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "2", "]"}], "\[Rule]", 
      FractionBox["1.94348", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "1", "]"}], "\[Rule]", 
      FractionBox["2.52795", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "2", "]"}], "\[Rule]", " ", 
      FractionBox["3.76156", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "\[Rule]", "\"\<rbc_example_fullinfo\>\""}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6339596591377106`*^9, 3.6339596955068197`*^9}, {
   3.633959732379898*^9, 3.633959752991946*^9}, {3.633960070120716*^9, 
   3.6339600859247494`*^9}, {3.640024132122167*^9, 3.640024144219194*^9}, 
   3.6400242582594986`*^9, {3.6455434493595963`*^9, 3.645543470826629*^9}, {
   3.6712949244770484`*^9, 3.671294930262067*^9}, {3.671300419742244*^9, 
   3.671300420991247*^9}, {3.6713886772211547`*^9, 3.6713887778117867`*^9}, {
   3.671388838203715*^9, 3.6713888451017246`*^9}, 3.7008340307723713`*^9, {
   3.700999469923583*^9, 3.7009994711155834`*^9}, {3.700999550447583*^9, 
   3.700999552918583*^9}, {3.7181915448126974`*^9, 3.7181915571307983`*^9}, {
   3.718191627596388*^9, 3.7181916384100246`*^9}, {3.718192979668417*^9, 
   3.718193003002504*^9}, {3.718793652953829*^9, 3.7187936642442465`*^9}, 
   3.7236708685944247`*^9, {3.7247695115582657`*^9, 3.72476953787053*^9}, 
   3.7367676619265585`*^9, {3.738722090947407*^9, 3.738722145375811*^9}, {
   3.7387221757078133`*^9, 3.7387223210827208`*^9}, 
   3.739025805166961*^9},ExpressionUUID->"1d6af4e0-9fe1-4c7e-8da8-\
680031bc877e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rules", "Subsection",
 CellChangeTimes->{{3.6339595387094145`*^9, 
  3.6339595391994147`*^9}},ExpressionUUID->"03f6ac53-fe02-411c-b007-\
33d73a67138d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"derivrule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "__", "]"}], "[", "_", "]"}], "[", "__", 
       "]"}]}], "\[RuleDelayed]", "\[VeryThinSpace]", 
     RowBox[{"d", "[", 
      RowBox[{"[", "0", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ssrule", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]", "\[Rule]", "0"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"xlag", "\[Rule]", "xvarss"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"xfunlist", "\[Rule]", "xvarss"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"yfunlist", "\[Rule]", "yvarss"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsrule", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"eps", "\[Rule]", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsprule1", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"epsp", "\[Rule]", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsprule2", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     SuperscriptBox["epsp", "2"], "\[Rule]", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ssvalrule", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xvarss", ",", "yvarss"}], "}"}], "]"}], "\[Rule]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xvarssval", ",", "yvarssval"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.63395949264032*^9, 3.6339595222303805`*^9}, 
   3.6339596303316517`*^9, {3.6339596996938286`*^9, 3.6339597085868464`*^9}, 
   3.7387221088937054`*^9},ExpressionUUID->"7d3dee19-1a4c-4aef-bc8c-\
2c36990739c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ergodic Mean of Switches", "Subsection",
 CellChangeTimes->{{3.6713988540823154`*^9, 
  3.671398860761698*^9}},ExpressionUUID->"e57cd8f1-db7e-451a-8ba5-\
6351c7015a36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ergodicA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "Pmat", "]"}], "-", 
      RowBox[{"IdentityMatrix", "[", "ns", "]"}]}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "ns"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ergodicvec", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "ergodicA", "]"}], ".", "ergodicA"}], "]"}],
       ".", 
      RowBox[{"Transpose", "[", "ergodicA", "]"}]}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", 
      RowBox[{"ns", "+", "1"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barrule", "=", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"tvarss", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"tvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "ns"}], "}"}]}], "]"}], ".", 
       "ergodicvec"}]}], "]"}], "/.", "parmrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parmrule", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"parmrule", ",", "barrule"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671398654954926*^9, 3.671398722018762*^9}, {
  3.6713987659072723`*^9, 3.671398814539054*^9}, {3.671398864178893*^9, 
  3.6713988730183983`*^9}, {3.671398931282731*^9, 
  3.67139893703506*^9}},ExpressionUUID->"fefe0d63-ad11-4c27-b900-\
dc25314f566e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Steady State Values", "Subsection",
 CellChangeTimes->{{3.6339595796525483`*^9, 
  3.6339595833025556`*^9}},ExpressionUUID->"42d25340-b1fc-4465-b85c-\
fe643d957145"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"F", "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], "/.",
    "epsrule"}], "//", "Chop"}], "\[IndentingNewLine]", 
 RowBox[{"xvarss", "=", 
  RowBox[{
   RowBox[{"xvarss", "/.", "ssvalrule"}], "/.", 
   "parmrule"}]}], "\[IndentingNewLine]", 
 RowBox[{"yvarss", "=", 
  RowBox[{
   RowBox[{"yvarss", "/.", "ssvalrule"}], "/.", "parmrule"}]}]}], "Input",
 CellChangeTimes->{{3.633959572295533*^9, 3.633959633157658*^9}, {
  3.6339597113568525`*^9, 3.633959726192885*^9}, {3.6339597688959785`*^9, 
  3.6339598101950927`*^9}, {3.6712948641547503`*^9, 3.671294873543782*^9}, {
  3.7008356251739902`*^9, 
  3.70083562567004*^9}},ExpressionUUID->"51c105b9-83de-48d2-b062-\
72eaa0452bbc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check", "Subsection",
 CellChangeTimes->{{3.6712894919236946`*^9, 3.671289493238699*^9}, {
  3.671290479215686*^9, 
  3.671290480971692*^9}},ExpressionUUID->"f5e88e27-bfd7-4d3a-9c37-\
eb24e634af0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"normcheck", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normcheck", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"F", "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}],
      "/.", "epsrule"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671289495140706*^9, 
  3.6712895262258925`*^9}},ExpressionUUID->"1e4fc9d1-f0e1-4934-aae9-\
76af63a6a327"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["First Order Approximation", "Section",
 CellChangeTimes->{{3.6339598205711174`*^9, 
  3.633959825021128*^9}},ExpressionUUID->"b337f694-05b5-4383-9794-\
f55bb1f9fb1e"],

Cell[CellGroupData[{

Cell["Matrices", "Subsection",
 CellChangeTimes->{{3.6339601061357975`*^9, 
  3.6339601075257998`*^9}},ExpressionUUID->"266dfb4e-4674-470d-bce0-\
30ed636e6306"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yvars", "/.", "funrulei"}], ",", 
          RowBox[{"{", "state", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
       RowBox[{"s", "\[Rule]", "ii"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"xvars", "/.", "funrulei"}], ",", 
          RowBox[{"{", "state", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
       RowBox[{"s", "\[Rule]", "ii"}]}]}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.633960110095804*^9, 3.6339601638149366`*^9}, {
   3.634304627903549*^9, 3.634304629174622*^9}, 
   3.6343046833577213`*^9},ExpressionUUID->"afef15ea-1df0-48db-9764-\
2999998a2a3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative for x", "Subsection",
 CellChangeTimes->{{3.6339598291911397`*^9, 
  3.6339598311171436`*^9}},ExpressionUUID->"31569976-571b-416f-8e47-\
77e7aacabc38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dFx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"F", ",", 
          RowBox[{"{", "xlag", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
       "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], "/.", 
    "epsrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dFx", "//", "MatrixForm"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"soln", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Flatten", "[", "dFx", "]"}], ")"}], "\[Equal]", "0"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6339598343581514`*^9, 3.6339599110193577`*^9}, {
  3.6343043630814023`*^9, 3.6343044729026837`*^9}, {3.6343045265027494`*^9, 
  3.634304531022008*^9}, {3.6343046414373236`*^9, 3.634304667309803*^9}, {
  3.634304699399639*^9, 3.6343047296213675`*^9}, {3.634311848871183*^9, 
  3.6343118712952147`*^9}, {3.640024288773563*^9, 3.6400242898535657`*^9}, {
  3.6400244039108343`*^9, 3.640024457960972*^9}, {3.6430298174143057`*^9, 
  3.6430298441158333`*^9}, {3.6430300877547684`*^9, 3.6430300961472487`*^9}, {
  3.645543377962493*^9, 3.6455433797924953`*^9}, {3.6455434106985397`*^9, 
  3.645543424060559*^9}, {3.6455434870886536`*^9, 
  3.6455434877946706`*^9}},ExpressionUUID->"c6af6d90-8df9-4211-a935-\
4a2fb807587c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check for MSS", "Subsection",
 CellChangeTimes->{{3.640024608975321*^9, 
  3.6400246113553267`*^9}},ExpressionUUID->"738c639e-7659-4fde-bf72-\
dcc931f01b36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"count", "=", "0"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "MSS", " ", "Solutions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "MSS", " ", "of", " ", "each", " ", "soln"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solution", "=", 
    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Construct", " ", "T", " ", "matrix"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalUpsilon]", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nx", "2"], "*", "ns"}], ",", 
       RowBox[{
        SuperscriptBox["nx", "2"], "*", "ns"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalUpsilon]", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ii", "-", "1"}], ")"}], "*", 
           SuperscriptBox["nx", "2"]}], "+", "1"}], ";;", 
         RowBox[{"ii", "*", 
          SuperscriptBox["nx", "2"]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ii", "-", "1"}], ")"}], "*", 
           SuperscriptBox["nx", "2"]}], "+", "1"}], ";;", 
         RowBox[{"ii", "*", 
          SuperscriptBox["nx", "2"]}]}]}], "]"}], "]"}], "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"H", "[", "ii", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "nx"}], ",", 
          RowBox[{"1", ";;", "nx"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"H", "[", "ii", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "nx"}], ",", 
          RowBox[{"1", ";;", "nx"}]}], "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tmat", "=", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "Pmat", "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", 
        SuperscriptBox["nx", "2"], "]"}]}], "]"}], ".", 
     "\[CapitalUpsilon]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "Eigenvalues", " ", "of", " ", "T"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", 
     RowBox[{
      RowBox[{"Dimensions", "[", "soln", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"Max", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{
          RowBox[{"Tmat", "/.", "parmrule"}], "/.", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}], "]"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"Eigenvalues", "[", 
           RowBox[{
            RowBox[{"Tmat", "/.", "parmrule"}], "/.", 
            RowBox[{"soln", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}], "]"}], "<", 
        "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "MSS"}], ",", " ", 
         RowBox[{
         "increment", " ", "count", " ", "and", " ", "save", " ", "as", " ", 
          "solution"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"count", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"solution", "=", 
         RowBox[{"soln", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"count", "//", "Print"}], "\[IndentingNewLine]", 
 RowBox[{"solution", "//", "Print"}]}], "Input",
 CellChangeTimes->{{3.640024614325334*^9, 
  3.6400246768855286`*^9}},ExpressionUUID->"ad9caefe-fb3a-49f8-a028-\
a0aafd84e713"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative for \[Epsilon]", "Subsection",
 CellChangeTimes->{{3.6339599150693665`*^9, 
  3.6339599207093773`*^9}},ExpressionUUID->"91ded57c-ed25-4feb-bc05-\
7dded1a2d864"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dF\[Epsilon]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"F", ",", 
           RowBox[{"{", "eps", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
        "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], "/.", 
     "epsrule"}], "/.", "solution"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"solution", ",", 
      RowBox[{"Solve", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{"dF\[Epsilon]", "\[Equal]", "0"}], "]"}], "]"}]}], "}"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.633959928411392*^9, 3.6339599808755093`*^9}, {
  3.6343045475589542`*^9, 3.634304567983122*^9}, {3.6343047417010584`*^9, 
  3.634304751901642*^9}, {3.6400243185996575`*^9, 3.6400243197266607`*^9}, {
  3.6400246814285398`*^9, 3.640024702928584*^9}, {3.643029871927424*^9, 
  3.643029873524515*^9}},ExpressionUUID->"fd8760e2-4a4c-48ba-a24a-\
4c6ee67d1165"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative for \[Chi]", "Subsection",
 CellChangeTimes->{{3.6339599150693665`*^9, 3.6339599207093773`*^9}, {
  3.6339599873015223`*^9, 
  3.6339599895315266`*^9}},ExpressionUUID->"46802aac-e90f-44a0-a171-\
5a0777a48358"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dF\[Chi]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"F", ",", 
            RowBox[{"{", "\[Chi]", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
         "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], "/.", 
      "epsrule"}], "/.", "epsprule1"}], "/.", "solution"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"solution", ",", 
      RowBox[{"Solve", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{"dF\[Chi]", "\[Equal]", "0"}], "]"}], "]"}]}], "}"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.633959928411392*^9, 3.633959997538543*^9}, {
   3.63396005281668*^9, 3.633960056626687*^9}, {3.6343047632772923`*^9, 
   3.6343047993563557`*^9}, 3.640024326293674*^9, {3.640024684362547*^9, 
   3.640024702140583*^9}, {3.643029866549116*^9, 
   3.643029868852248*^9}},ExpressionUUID->"d4ee8354-dc85-4bc4-98f0-\
8b17898958bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check Accuracy", "Subsection",
 CellChangeTimes->{{3.671289338092142*^9, 
  3.671289340019149*^9}},ExpressionUUID->"35be6bff-ab4a-4131-b7a7-\
7d56a9a07325"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"normcheck", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"F", ",", 
            RowBox[{"{", "state", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
         "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], "/.", 
      "solution"}], "/.", "epsprule1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712893409271526`*^9, 3.6712893819092865`*^9}, {
  3.6712895640110188`*^9, 3.6712895942061605`*^9}, {3.6712896436073203`*^9, 
  3.671289676141431*^9}},ExpressionUUID->"0acd6792-7ed9-452b-a83a-\
1cccc6b24efb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrices", "Subsection",
 CellChangeTimes->{{3.6339601061357975`*^9, 
  3.6339601075257998`*^9}},ExpressionUUID->"b64b80d1-0860-49bd-8992-\
cff39d963faa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{"G", "[", "ii", "]"}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{"H", "[", "ii", "]"}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"G", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"H", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.633960110095804*^9, 3.6339601638149366`*^9}, 
   3.634304689214056*^9, {3.634304827852986*^9, 3.634304846373045*^9}, {
   3.63430588970172*^9, 3.6343058987102356`*^9}, {3.634306577865652*^9, 
   3.63430659094567*^9}, {3.640024690078559*^9, 
   3.6400246927385645`*^9}},ExpressionUUID->"7c5a89bc-bb37-4721-994c-\
ccc6e5685c89"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Second Order Perturbation", "Section",
 CellChangeTimes->{{3.5497122872214556`*^9, 
  3.5497122923997517`*^9}},ExpressionUUID->"44bd62dd-35c8-426d-90d9-\
93646d10a344"],

Cell[CellGroupData[{

Cell["Taking Derivatives", "Subsection",
 CellChangeTimes->{{3.5360061098685827`*^9, 3.5360061175960245`*^9}, {
  3.549712322283461*^9, 
  3.549712324832607*^9}},ExpressionUUID->"88a3924e-d086-4178-96d3-\
439634878323"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d2Fss", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", 
     RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "ii"}], ",", 
       RowBox[{"jj", "\[LessEqual]", 
        RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2Fss", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"d2Fss", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"F", ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "}"}]}], "]"}], "/.", 
                  "derivrule"}], "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", 
               "epsrule"}], "/.", "parmrule"}], "/.", "solution"}]}], "}"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.537299978328273*^9, 3.537299997175351*^9}, {
   3.537300083073264*^9, 3.5373000862864475`*^9}, {3.537300163827883*^9, 
   3.5373001732244205`*^9}, {3.5373003107722874`*^9, 
   3.5373003168296337`*^9}, {3.5373003935210204`*^9, 
   3.5373004184064436`*^9}, {3.537300452350385*^9, 3.5373004560755987`*^9}, {
   3.53730057114118*^9, 3.537300634153784*^9}, {3.537301478644086*^9, 
   3.537301485445475*^9}, {3.5434220185638*^9, 3.5434220187398*^9}, {
   3.5435781071776013`*^9, 3.543578107377613*^9}, {3.544187785762565*^9, 
   3.5441877859455757`*^9}, {3.5441887901490126`*^9, 
   3.5441887903490243`*^9}, {3.5442791108333244`*^9, 
   3.5442791141095114`*^9}, {3.549712615232217*^9, 3.549712615678242*^9}, {
   3.6156481997036157`*^9, 3.6156481998796253`*^9}, {3.6401057397408013`*^9, 
   3.640105740040802*^9}, {3.6404521792490096`*^9, 3.6404521911990385`*^9}, {
   3.640544796590741*^9, 3.6405447968207417`*^9}, 3.641049403027667*^9, {
   3.6410494444920387`*^9, 3.6410494457391095`*^9}, {3.641049483227254*^9, 
   3.641049483595275*^9}, {3.641049529506901*^9, 3.6410495298909225`*^9}, {
   3.643043852932678*^9, 3.643043854090684*^9}, {3.6430439983602304`*^9, 
   3.643044001917242*^9}},ExpressionUUID->"a2439754-ad54-4e13-a6db-\
5b4e54525931"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expectations of Future Shocks", "Subsection",
 CellChangeTimes->{{3.5497123305569344`*^9, 
  3.5497123432656612`*^9}},ExpressionUUID->"7416b10d-e122-4b4f-b523-\
51c121002ce0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"E0", ",", "E1", ",", "E2"}], "}"}], "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"d2Fss", ",", "epsp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2Fss", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", "E0", "]"}], "+", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "E2", "]"}], ".", "epsp", ".", "epsp"}], 
        "]"}]}], "/.", "epsprule2"}], "/.", "epsprule1"}], "/.", 
    "epsrule"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5369487634414787`*^9, 3.5369488100481443`*^9}, {
   3.5369488943369656`*^9, 3.5369489014713736`*^9}, {3.536949133624652*^9, 
   3.536949140994074*^9}, {3.536951585376768*^9, 3.536951592646381*^9}, 
   3.537301741329111*^9, {3.5373019012662587`*^9, 3.5373019028413486`*^9}, 
   3.543244502227271*^9, 3.5432447490863905`*^9, {3.543245043350221*^9, 
   3.543245044749301*^9}, {3.5432453262013993`*^9, 3.5432453314847016`*^9}, 
   3.5432456069484572`*^9, {3.543245724396175*^9, 3.543245729471465*^9}, 
   3.543246052774957*^9, {3.5434220218898*^9, 3.5434220220338*^9}, {
   3.5435781082076607`*^9, 3.5435781083996716`*^9}, {3.54418778846472*^9, 
   3.5441877886487303`*^9}, {3.544188792842167*^9, 3.5441887930241776`*^9}, {
   3.5442791146195407`*^9, 3.5442791160976257`*^9}, 3.549712493047228*^9, {
   3.6430438100985355`*^9, 3.643043812008541*^9}, {3.6430440418653727`*^9, 
   3.6430440422543755`*^9}},ExpressionUUID->"99a8d119-f0d6-4248-9939-\
7286dfde3437"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving Linear System", "Subsection",
 CellChangeTimes->{{3.549712347193886*^9, 
  3.5497123502800627`*^9}},ExpressionUUID->"93e08d94-fa6f-488a-b000-\
a0b576c4b910"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Variables", "[", "d2Fss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"NN", ",", "MM"}], "}"}], "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"d2Fss", ",", "vars"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"solution", ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"vars", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Inverse", "[", "MM", "]"}], ".", "NN"}]}], ")"}]}], 
       "]"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5369283351621113`*^9, 3.5369283655028467`*^9}, {
  3.53692840122289*^9, 3.536928477952279*^9}, {3.536928545021115*^9, 
  3.5369285908757377`*^9}, {3.5369289031856008`*^9, 3.536928948024165*^9}, {
  3.5434220240978003`*^9, 3.5434220242578*^9}, {3.5435781090947113`*^9, 
  3.543578109334725*^9}, {3.5441877912068768`*^9, 3.544187791366886*^9}, {
  3.544188795895342*^9, 3.5441887960943527`*^9}, {3.5442791171206837`*^9, 
  3.5442791192468057`*^9}},ExpressionUUID->"fc08ce29-5fe2-455c-9ddb-\
038cb72343ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check Accuracy", "Subsection",
 CellChangeTimes->{{3.6712896946964912`*^9, 
  3.6712897012435565`*^9}},ExpressionUUID->"e8393558-5ae2-4b21-9c22-\
c424d6c5165d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"normcheck", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "=", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"F", ",", 
              RowBox[{"{", 
               RowBox[{"state", ",", "2"}], "}"}]}], "]"}], "/.", 
            "derivrule"}], "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", 
         "parmrule"}], "/.", "solution"}], "]"}], "]"}], "/.", "epsprule2"}], 
    "/.", "epsprule1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6712897026725626`*^9, 3.6712897896489286`*^9}, {
   3.6712899073233624`*^9, 3.6712899138883877`*^9}, {3.671289948607499*^9, 
   3.6712899509955063`*^9}, 3.671289991208688*^9, {3.671290053576893*^9, 
   3.6712900589029107`*^9}},ExpressionUUID->"18bd94be-0b4a-499a-b526-\
b3706060291f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Saving Solution", "Subsection",
 CellChangeTimes->{{3.5360044033569756`*^9, 
  3.5360044090172997`*^9}},ExpressionUUID->"cd35a9e5-3944-45a2-a0e9-\
8049884af5ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G2", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"yvars", "/.", "funrulei"}], ",", 
           RowBox[{"{", 
            RowBox[{"state", ",", "2"}], "}"}]}], "]"}], "/.", "derivrule"}], 
        "/.", 
        RowBox[{"s", "\[Rule]", "ii"}]}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G2", "[", "ii", "]"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"G2", "[", "ii", "]"}], "]"}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"nx", "+", "ne", "+", "1"}], ")"}], "2"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H2", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"xvars", "/.", "funrulei"}], ",", 
           RowBox[{"{", 
            RowBox[{"state", ",", "2"}], "}"}]}], "]"}], "/.", "derivrule"}], 
        "/.", 
        RowBox[{"s", "\[Rule]", "ii"}]}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H2", "[", "ii", "]"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"H2", "[", "ii", "]"}], "]"}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"nx", "+", "ne", "+", "1"}], ")"}], "2"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"G2", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"H2", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.536004455513959*^9, 3.536004467257631*^9}, {
   3.536004644196751*^9, 3.536004644668778*^9}, {3.536004787317937*^9, 
   3.536004857026924*^9}, {3.5360053244116573`*^9, 3.536005324971689*^9}, {
   3.536005462369548*^9, 3.536005577646141*^9}, 3.536005611583082*^9, {
   3.5360056512653522`*^9, 3.536005652295411*^9}, {3.536005708824644*^9, 
   3.536005738658351*^9}, {3.536005827619439*^9, 3.5360058838716564`*^9}, {
   3.536006084104109*^9, 3.536006088804378*^9}, {3.549712742721509*^9, 
   3.549712744719623*^9}, {3.61565529099061*^9, 3.615655292573701*^9}, {
   3.6401057315107813`*^9, 3.6401057347307887`*^9}, {3.643046654887161*^9, 
   3.643046686536207*^9}, {3.6430467430632906`*^9, 3.6430467447942934`*^9}, {
   3.7008365596447763`*^9, 
   3.700836564194045*^9}},ExpressionUUID->"b43b4bb4-d1d0-4d16-b1ab-\
1ae4d7185228"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Third Order Perturbation", "Section",
 CellChangeTimes->{{3.5497122872214556`*^9, 3.5497122923997517`*^9}, {
  3.7004996895186043`*^9, 
  3.700499690757675*^9}},ExpressionUUID->"6941e6c2-badb-4a0a-b635-\
aa8707b072d9"],

Cell[CellGroupData[{

Cell["Taking Derivatives", "Subsection",
 CellChangeTimes->{{3.5360061098685827`*^9, 3.5360061175960245`*^9}, {
  3.549712322283461*^9, 
  3.549712324832607*^9}},ExpressionUUID->"31ff3f7d-d453-48b9-b2c2-\
27e6309d4324"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d3Fss", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", 
     RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "ii"}], ",", 
       RowBox[{"jj", "\[LessEqual]", 
        RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"kk", "=", "jj"}], ",", 
          RowBox[{"kk", "\[LessEqual]", 
           RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
          RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"d3Fss", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"d3Fss", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"F", ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], "}"}]}], "]"}], "/.", 
                    "derivrule"}], "/.", "ssrule"}], "/.", "ssvalrule"}], "/.",
                   "epsrule"}], "/.", "parmrule"}], "/.", "solution"}]}], 
              "}"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.537299978328273*^9, 3.537299997175351*^9}, {
   3.537300083073264*^9, 3.5373000862864475`*^9}, {3.537300163827883*^9, 
   3.5373001732244205`*^9}, {3.5373003107722874`*^9, 
   3.5373003168296337`*^9}, {3.5373003935210204`*^9, 
   3.5373004184064436`*^9}, {3.537300452350385*^9, 3.5373004560755987`*^9}, {
   3.53730057114118*^9, 3.537300634153784*^9}, {3.537301478644086*^9, 
   3.537301485445475*^9}, {3.5434220185638*^9, 3.5434220187398*^9}, {
   3.5435781071776013`*^9, 3.543578107377613*^9}, {3.544187785762565*^9, 
   3.5441877859455757`*^9}, {3.5441887901490126`*^9, 
   3.5441887903490243`*^9}, {3.5442791108333244`*^9, 
   3.5442791141095114`*^9}, {3.549712615232217*^9, 3.549712615678242*^9}, {
   3.6156481997036157`*^9, 3.6156481998796253`*^9}, {3.6401057397408013`*^9, 
   3.640105740040802*^9}, {3.6404521792490096`*^9, 3.6404521911990385`*^9}, {
   3.640544796590741*^9, 3.6405447968207417`*^9}, 3.641049403027667*^9, {
   3.6410494444920387`*^9, 3.6410494457391095`*^9}, {3.641049483227254*^9, 
   3.641049483595275*^9}, {3.641049529506901*^9, 3.6410495298909225`*^9}, {
   3.643043852932678*^9, 3.643043854090684*^9}, {3.6430439983602304`*^9, 
   3.643044001917242*^9}, {3.694347075449092*^9, 3.6943471116109147`*^9}, {
   3.6943471973405557`*^9, 
   3.694347198151289*^9}},ExpressionUUID->"3e471b32-3f48-4202-bdb3-\
567f0d8f6fdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expectations of Future Shocks", "Subsection",
 CellChangeTimes->{{3.5497123305569344`*^9, 
  3.5497123432656612`*^9}},ExpressionUUID->"fc201640-899e-498a-bc1c-\
28406f2ef7fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"E0", ",", "E1", ",", "E2", ",", "E3"}], "}"}], "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"d3Fss", ",", "epsp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d3Fss", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", "E0", "]"}], "+", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "E2", "]"}], ".", "epsp", ".", "epsp"}], 
        "]"}]}], "/.", "epsprule2"}], "/.", "epsprule1"}], "/.", 
    "epsrule"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5369487634414787`*^9, 3.5369488100481443`*^9}, {
   3.5369488943369656`*^9, 3.5369489014713736`*^9}, {3.536949133624652*^9, 
   3.536949140994074*^9}, {3.536951585376768*^9, 3.536951592646381*^9}, 
   3.537301741329111*^9, {3.5373019012662587`*^9, 3.5373019028413486`*^9}, 
   3.543244502227271*^9, 3.5432447490863905`*^9, {3.543245043350221*^9, 
   3.543245044749301*^9}, {3.5432453262013993`*^9, 3.5432453314847016`*^9}, 
   3.5432456069484572`*^9, {3.543245724396175*^9, 3.543245729471465*^9}, 
   3.543246052774957*^9, {3.5434220218898*^9, 3.5434220220338*^9}, {
   3.5435781082076607`*^9, 3.5435781083996716`*^9}, {3.54418778846472*^9, 
   3.5441877886487303`*^9}, {3.544188792842167*^9, 3.5441887930241776`*^9}, {
   3.5442791146195407`*^9, 3.5442791160976257`*^9}, 3.549712493047228*^9, {
   3.6430438100985355`*^9, 3.643043812008541*^9}, {3.6430440418653727`*^9, 
   3.6430440422543755`*^9}, {3.700499795838685*^9, 3.7004997999589205`*^9}, {
   3.7004999284392695`*^9, 
   3.7004999294783287`*^9}},ExpressionUUID->"b361a354-2631-4946-af20-\
1942d7a4a90a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving Linear System", "Subsection",
 CellChangeTimes->{{3.549712347193886*^9, 
  3.5497123502800627`*^9}},ExpressionUUID->"36f752a1-ed7a-448f-bd6d-\
30a0099cd1e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Variables", "[", "d3Fss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"NN", ",", "MM"}], "}"}], "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"d3Fss", ",", "vars"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"solution", ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"vars", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Inverse", "[", "MM", "]"}], ".", "NN"}]}], ")"}]}], 
       "]"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5369283351621113`*^9, 3.5369283655028467`*^9}, {
  3.53692840122289*^9, 3.536928477952279*^9}, {3.536928545021115*^9, 
  3.5369285908757377`*^9}, {3.5369289031856008`*^9, 3.536928948024165*^9}, {
  3.5434220240978003`*^9, 3.5434220242578*^9}, {3.5435781090947113`*^9, 
  3.543578109334725*^9}, {3.5441877912068768`*^9, 3.544187791366886*^9}, {
  3.544188795895342*^9, 3.5441887960943527`*^9}, {3.5442791171206837`*^9, 
  3.5442791192468057`*^9}, {3.694347114757768*^9, 
  3.694347116119137*^9}},ExpressionUUID->"a2619fda-2db1-4f20-8003-\
b71f99429eec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Saving Solution", "Subsection",
 CellChangeTimes->{{3.5360044033569756`*^9, 
  3.5360044090172997`*^9}},ExpressionUUID->"ebc52162-127d-4849-a1c5-\
8819f882b682"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G3", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"yvars", "/.", "funrulei"}], ",", 
           RowBox[{"{", 
            RowBox[{"state", ",", "3"}], "}"}]}], "]"}], "/.", "derivrule"}], 
        "/.", 
        RowBox[{"s", "\[Rule]", "ii"}]}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G3", "[", "ii", "]"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"G3", "[", "ii", "]"}], "]"}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"nx", "+", "ne", "+", "1"}], ")"}], "3"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H3", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"xvars", "/.", "funrulei"}], ",", 
           RowBox[{"{", 
            RowBox[{"state", ",", "3"}], "}"}]}], "]"}], "/.", "derivrule"}], 
        "/.", 
        RowBox[{"s", "\[Rule]", "ii"}]}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H3", "[", "ii", "]"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"H3", "[", "ii", "]"}], "]"}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"nx", "+", "ne", "+", "1"}], ")"}], "3"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"G3", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"H3", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.536004455513959*^9, 3.536004467257631*^9}, {
   3.536004644196751*^9, 3.536004644668778*^9}, {3.536004787317937*^9, 
   3.536004857026924*^9}, {3.5360053244116573`*^9, 3.536005324971689*^9}, {
   3.536005462369548*^9, 3.536005577646141*^9}, 3.536005611583082*^9, {
   3.5360056512653522`*^9, 3.536005652295411*^9}, {3.536005708824644*^9, 
   3.536005738658351*^9}, {3.536005827619439*^9, 3.5360058838716564`*^9}, {
   3.536006084104109*^9, 3.536006088804378*^9}, {3.549712742721509*^9, 
   3.549712744719623*^9}, {3.61565529099061*^9, 3.615655292573701*^9}, {
   3.6401057315107813`*^9, 3.6401057347307887`*^9}, {3.643046654887161*^9, 
   3.643046686536207*^9}, {3.6430467430632906`*^9, 3.6430467447942934`*^9}, {
   3.6940164950434523`*^9, 3.6940164962115192`*^9}, {3.69434711952006*^9, 
   3.6943471385588865`*^9}},ExpressionUUID->"29ea2d23-378a-4882-8ae6-\
b5266230b760"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1264, 637},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 216, 4, 53, "Subsection",ExpressionUUID->"30d303cc-e8c2-46a4-b231-b754466180d1"],
Cell[799, 28, 711, 16, 67, "Input",ExpressionUUID->"830b0594-5990-4ed9-946f-09c5d74899b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1547, 49, 156, 3, 53, "Subsection",ExpressionUUID->"aae23253-ce10-4142-8ccc-3a56e12d63e3"],
Cell[1706, 54, 3614, 90, 225, "Input",ExpressionUUID->"725c185d-e996-47cc-a4f8-e4ab8f860ea0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5357, 149, 246, 4, 53, "Subsection",ExpressionUUID->"d4741a9d-9ae7-4d01-978a-d9c071b274f2"],
Cell[5606, 155, 7031, 146, 447, "Input",ExpressionUUID->"02f26ce0-4ce4-4485-ad87-a86389b96c50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12674, 306, 159, 3, 53, "Subsection",ExpressionUUID->"1708d7ce-b0de-480a-9004-7ee0b5d7398a"],
Cell[12836, 311, 4686, 114, 371, "Input",ExpressionUUID->"7abe376f-f799-4387-8bd4-48fc44948f94"],
Cell[17525, 427, 1606, 42, 162, "Input",ExpressionUUID->"993ff909-8db2-4c81-88d4-71a19a8d8f2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19168, 474, 236, 4, 53, "Subsection",ExpressionUUID->"c53bbeac-3dea-433b-8d61-0f28bfb2a437"],
Cell[19407, 480, 2126, 44, 67, "Input",ExpressionUUID->"b59aba1d-ff20-477c-9a2e-d45d96ffd18a"],
Cell[21536, 526, 1697, 40, 86, "Input",ExpressionUUID->"77f2f6d4-996e-4645-944e-7f27bed2c954"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23270, 571, 161, 3, 67, "Section",ExpressionUUID->"af7a2dbd-5680-45c4-a0d1-c6467d82a1e2"],
Cell[CellGroupData[{
Cell[23456, 578, 173, 3, 53, "Subsection",ExpressionUUID->"359715db-236d-4307-9aa9-31b7f654da35"],
Cell[23632, 583, 1967, 51, 201, "Input",ExpressionUUID->"2a5a472c-f850-462a-af6c-de1814e55a26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25636, 639, 160, 3, 53, "Subsection",ExpressionUUID->"625815a2-c2e6-4dad-8818-bc68f291dcde"],
Cell[25799, 644, 2421, 43, 413, "Input",ExpressionUUID->"1d6af4e0-9fe1-4c7e-8da8-680031bc877e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28257, 692, 157, 3, 53, "Subsection",ExpressionUUID->"03f6ac53-fe02-411c-b007-33d73a67138d"],
Cell[28417, 697, 1892, 53, 148, "Input",ExpressionUUID->"7d3dee19-1a4c-4aef-bc8c-2c36990739c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30346, 755, 174, 3, 53, "Subsection",ExpressionUUID->"e57cd8f1-db7e-451a-8ba5-6351c7015a36"],
Cell[30523, 760, 1735, 52, 86, "Input",ExpressionUUID->"fefe0d63-ad11-4c27-b900-dc25314f566e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32295, 817, 171, 3, 53, "Subsection",ExpressionUUID->"42d25340-b1fc-4465-b85c-fe643d957145"],
Cell[32469, 822, 767, 19, 67, "Input",ExpressionUUID->"51c105b9-83de-48d2-b062-72eaa0452bbc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33273, 846, 204, 4, 53, "Subsection",ExpressionUUID->"f5e88e27-bfd7-4d3a-9c37-eb24e634af0c"],
Cell[33480, 852, 628, 19, 48, "Input",ExpressionUUID->"1e4fc9d1-f0e1-4934-aae9-76af63a6a327"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34157, 877, 172, 3, 67, "Section",ExpressionUUID->"b337f694-05b5-4383-9794-f55bb1f9fb1e"],
Cell[CellGroupData[{
Cell[34354, 884, 160, 3, 53, "Subsection",ExpressionUUID->"266dfb4e-4674-470d-bce0-30ed636e6306"],
Cell[34517, 889, 1106, 30, 86, "Input",ExpressionUUID->"afef15ea-1df0-48db-9764-2999998a2a3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35660, 924, 168, 3, 53, "Subsection",ExpressionUUID->"31569976-571b-416f-8e47-77e7aacabc38"],
Cell[35831, 929, 1430, 34, 67, "Input",ExpressionUUID->"c6af6d90-8df9-4211-a935-4a2fb807587c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37298, 968, 163, 3, 53, "Subsection",ExpressionUUID->"738c639e-7659-4fde-bf72-dcc931f01b36"],
Cell[37464, 973, 4501, 129, 411, "Input",ExpressionUUID->"ad9caefe-fb3a-49f8-a028-a0aafd84e713"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42002, 1107, 177, 3, 53, "Subsection",ExpressionUUID->"91ded57c-ed25-4feb-bc05-7dded1a2d864"],
Cell[42182, 1112, 1072, 28, 48, "Input",ExpressionUUID->"fd8760e2-4a4c-48ba-a24a-4c6ee67d1165"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43291, 1145, 226, 4, 53, "Subsection",ExpressionUUID->"46802aac-e90f-44a0-a171-5a0777a48358"],
Cell[43520, 1151, 1083, 30, 48, "Input",ExpressionUUID->"d4ee8354-dc85-4bc4-98f0-8b17898958bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44640, 1186, 162, 3, 53, "Subsection",ExpressionUUID->"35be6bff-ab4a-4131-b7a7-7d56a9a07325"],
Cell[44805, 1191, 728, 20, 28, "Input",ExpressionUUID->"0acd6792-7ed9-452b-a83a-1cccc6b24efb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45570, 1216, 160, 3, 53, "Subsection",ExpressionUUID->"b64b80d1-0860-49bd-8992-cff39d963faa"],
Cell[45733, 1221, 1298, 33, 124, "Input",ExpressionUUID->"7c5a89bc-bb37-4721-994c-ccc6e5685c89"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47080, 1260, 174, 3, 67, "Section",ExpressionUUID->"44bd62dd-35c8-426d-90d9-93646d10a344"],
Cell[CellGroupData[{
Cell[47279, 1267, 219, 4, 53, "Subsection",ExpressionUUID->"88a3924e-d086-4178-96d3-439634878323"],
Cell[47501, 1273, 2762, 59, 124, "Input",ExpressionUUID->"a2439754-ad54-4e13-a6db-5b4e54525931"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50300, 1337, 181, 3, 53, "Subsection",ExpressionUUID->"7416b10d-e122-4b4f-b523-51c121002ce0"],
Cell[50484, 1342, 1564, 32, 48, "Input",ExpressionUUID->"99a8d119-f0d6-4248-9939-7286dfde3437"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52085, 1379, 171, 3, 53, "Subsection",ExpressionUUID->"93e08d94-fa6f-488a-b000-a0b576c4b910"],
Cell[52259, 1384, 1215, 29, 67, "Input",ExpressionUUID->"fc08ce29-5fe2-455c-9ddb-038cb72343ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53511, 1418, 166, 3, 53, "Subsection",ExpressionUUID->"e8393558-5ae2-4b21-9c22-c424d6c5165d"],
Cell[53680, 1423, 953, 25, 28, "Input",ExpressionUUID->"18bd94be-0b4a-499a-b526-b3706060291f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54670, 1453, 167, 3, 53, "Subsection",ExpressionUUID->"cd35a9e5-3944-45a2-a0e9-8049884af5ff"],
Cell[54840, 1458, 3001, 76, 180, "Input",ExpressionUUID->"b43b4bb4-d1d0-4d16-b1ab-1ae4d7185228"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57890, 1540, 224, 4, 67, "Section",ExpressionUUID->"6941e6c2-badb-4a0a-b635-aa8707b072d9"],
Cell[CellGroupData[{
Cell[58139, 1548, 219, 4, 53, "Subsection",ExpressionUUID->"31ff3f7d-d453-48b9-b2c2-27e6309d4324"],
Cell[58361, 1554, 3363, 72, 162, "Input",ExpressionUUID->"3e471b32-3f48-4202-bdb3-567f0d8f6fdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61761, 1631, 181, 3, 53, "Subsection",ExpressionUUID->"fc201640-899e-498a-bc1c-28406f2ef7fc"],
Cell[61945, 1636, 1681, 34, 48, "Input",ExpressionUUID->"b361a354-2631-4946-af20-1942d7a4a90a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63663, 1675, 171, 3, 53, "Subsection",ExpressionUUID->"36f752a1-ed7a-448f-bd6d-30a0099cd1e6"],
Cell[63837, 1680, 1264, 30, 67, "Input",ExpressionUUID->"a2619fda-2db1-4f20-8003-b71f99429eec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65138, 1715, 167, 3, 53, "Subsection",ExpressionUUID->"ebc52162-127d-4849-a1c5-8819f882b682"],
Cell[65308, 1720, 3050, 76, 180, "Input",ExpressionUUID->"29ea2d23-378a-4882-8ae6-b5266230b760"]
}, Open  ]]
}, Open  ]]
}
]
*)

