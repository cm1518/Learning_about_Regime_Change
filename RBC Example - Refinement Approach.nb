(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87243,       2180]
NotebookOptionsPosition[     79727,       2040]
NotebookOutlinePosition[     80069,       2055]
CellTagsIndexPosition[     80026,       2052]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Model Definition", "Section",
 CellChangeTimes->{{3.724017107927267*^9, 
  3.7240171126021376`*^9}},ExpressionUUID->"122cb7c0-745c-4a64-a43f-\
94e07bffb9a2"],

Cell[CellGroupData[{

Cell["Clear Workspace", "Subsection",
 CellChangeTimes->{{3.465644519984375*^9, 3.465644520671875*^9}, {
  3.5824075291179495`*^9, 
  3.5824075314267535`*^9}},ExpressionUUID->"740a3a87-e734-407a-97bc-\
0392276c805d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4628993695007*^9, 3.4628993711507*^9}, {
  3.4628995236937*^9, 3.4628995417777*^9}, {3.4629012084867*^9, 
  3.4629012144207*^9}, {3.4629012669617*^9, 3.4629012747977*^9}, {
  3.4629013846857*^9, 3.4629013853077*^9}, {3.4741254201057*^9, 
  3.4741254219427*^9}, {3.6286038941019564`*^9, 3.628603894301956*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"aaf62a1a-ec72-443a-a17e-95e43c06500b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["System", "Subsection",
 CellChangeTimes->{{3.632763129680771*^9, 
  3.6327631374517813`*^9}},ExpressionUUID->"81897418-8647-4ee1-a562-\
3c0f001b7362"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Beta]", "*", 
     SuperscriptBox[
      RowBox[{"Exp", "[", "z", "]"}], 
      FractionBox["1", 
       RowBox[{"\[Alpha]", "-", "1"}]]], "*", 
     FractionBox[
      RowBox[{"Exp", "[", "c", "]"}], 
      RowBox[{"Exp", "[", "cp", "]"}]], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", "*", 
        RowBox[{"Exp", "[", "zp", "]"}], "*", 
        SuperscriptBox[
         RowBox[{"Exp", "[", "k", "]"}], 
         RowBox[{"\[Alpha]", "-", "1"}]]}], "+", "1", "-", "\[Delta]"}], 
      ")"}]}], "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "z", "]"}], "*", 
     SuperscriptBox[
      RowBox[{"Exp", "[", "klag", "]"}], "\[Alpha]"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Delta]"}], ")"}], "*", 
     RowBox[{"Exp", "[", "klag", "]"}]}], "-", 
    RowBox[{"Exp", "[", "c", "]"}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Exp", "[", "z", "]"}], 
      FractionBox["1", 
       RowBox[{"1", "-", "\[Alpha]"}]]], "*", 
     RowBox[{"Exp", "[", "k", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Mu]", "[", "s", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Sigma]", "[", "s", "]"}], "*", "\[Epsilon]"}], "-", "z"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "4", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{
       FractionBox["1", 
        RowBox[{"\[Sigma]", "[", "1", "]"}]], 
       RowBox[{"\[Phi]", "[", 
        FractionBox[
         RowBox[{"z", "-", 
          RowBox[{"\[Mu]", "[", "1", "]"}]}], 
         RowBox[{"\[Sigma]", "[", "1", "]"}]], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "*", 
          FractionBox["1", 
           RowBox[{"1", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", "\[Eta]1lag"}], "]"}]}]]}], "+", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"2", ",", "1"}], "]"}], 
          RowBox[{"(", 
           FractionBox["1", 
            RowBox[{"1", "+", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", "\[Eta]2lag"}], "]"}]}]], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"\[Sigma]", "[", "2", "]"}]], 
       RowBox[{"\[Phi]", "[", 
        FractionBox[
         RowBox[{"z", "-", 
          RowBox[{"\[Mu]", "[", "2", "]"}]}], 
         RowBox[{"\[Sigma]", "[", "2", "]"}]], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "*", 
          FractionBox["1", 
           RowBox[{"1", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", "\[Eta]1lag"}], "]"}]}]]}], "+", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"2", ",", "2"}], "]"}], 
          RowBox[{"(", 
           FractionBox["1", 
            RowBox[{"1", "+", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", "\[Eta]2lag"}], "]"}]}]], ")"}]}]}], ")"}]}]], 
     "]"}], "-", "\[Eta]1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"[", "5", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{
       FractionBox["1", 
        RowBox[{"\[Sigma]", "[", "2", "]"}]], 
       RowBox[{"\[Phi]", "[", 
        FractionBox[
         RowBox[{"z", "-", 
          RowBox[{"\[Mu]", "[", "2", "]"}]}], 
         RowBox[{"\[Sigma]", "[", "2", "]"}]], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "*", 
          FractionBox["1", 
           RowBox[{"1", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", "\[Eta]1lag"}], "]"}]}]]}], "+", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"2", ",", "2"}], "]"}], 
          RowBox[{"(", 
           FractionBox["1", 
            RowBox[{"1", "+", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", "\[Eta]2lag"}], "]"}]}]], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"\[Sigma]", "[", "1", "]"}]], 
       RowBox[{"\[Phi]", "[", 
        FractionBox[
         RowBox[{"z", "-", 
          RowBox[{"\[Mu]", "[", "1", "]"}]}], 
         RowBox[{"\[Sigma]", "[", "1", "]"}]], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "*", 
          FractionBox["1", 
           RowBox[{"1", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", "\[Eta]1lag"}], "]"}]}]]}], "+", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"2", ",", "1"}], "]"}], 
          RowBox[{"(", 
           FractionBox["1", 
            RowBox[{"1", "+", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", "\[Eta]2lag"}], "]"}]}]], ")"}]}]}], ")"}]}]], 
     "]"}], "-", "\[Eta]2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", "x_", "]"}], "=", 
   RowBox[{"PDF", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.632763139911785*^9, 3.632763409024165*^9}, {
   3.6327634402962093`*^9, 3.6327634419062114`*^9}, {3.6327664440591516`*^9, 
   3.632766444839153*^9}, {3.6327676791798964`*^9, 3.632767681219899*^9}, {
   3.6327677574030113`*^9, 3.6327677804430475`*^9}, {3.6327726542625003`*^9, 
   3.632772658667569*^9}, {3.6328297185501204`*^9, 3.6328297708812294`*^9}, {
   3.633298914164136*^9, 3.6332991251433735`*^9}, 3.6332992427930613`*^9, {
   3.633299334765042*^9, 3.6332993427150974`*^9}, {3.633299524691136*^9, 
   3.633299524756137*^9}, {3.6333504878910327`*^9, 3.6333507116743574`*^9}, {
   3.6339590973043876`*^9, 3.6339591617995176`*^9}, {3.6339600287766294`*^9, 
   3.633960029624631*^9}, {3.6340449218840046`*^9, 3.634044975794088*^9}, 
   3.6340467492274623`*^9, {3.634047259915187*^9, 3.6340472623751907`*^9}, {
   3.6340478147529707`*^9, 3.6340478156129713`*^9}, {3.634065576392748*^9, 
   3.6340658078312664`*^9}, {3.634065873161428*^9, 3.634065917988549*^9}, {
   3.634065979922675*^9, 3.634065997300711*^9}, {3.6340661837912064`*^9, 
   3.634066187480215*^9}, {3.6340662887755013`*^9, 3.634066288942502*^9}, 
   3.634066349902624*^9, {3.6340663840697594`*^9, 3.6340663885097704`*^9}, {
   3.6340665172240715`*^9, 3.6340665195640755`*^9}, {3.634306403228092*^9, 
   3.6343064261234016`*^9}, {3.634309163417501*^9, 3.6343091662576637`*^9}, {
   3.6343092358272495`*^9, 3.6343092369472513`*^9}, {3.634319383146976*^9, 
   3.634319384446978*^9}, {3.6343231397180777`*^9, 3.6343231406991343`*^9}, {
   3.640455574820058*^9, 3.640455605258133*^9}, {3.640456537782775*^9, 
   3.6404565586318045`*^9}, 3.640456625640938*^9, {3.642975732947666*^9, 
   3.642975734737669*^9}, 3.6455435633977995`*^9, 3.645543665331064*^9, {
   3.671295391147991*^9, 3.6712953916979923`*^9}, {3.6712954952684317`*^9, 
   3.6712955216025686`*^9}, {3.700499411910726*^9, 3.7004994886791167`*^9}, {
   3.700500034119314*^9, 3.7005000789278774`*^9}, {3.7005912797480097`*^9, 
   3.7005912830906754`*^9}, {3.7005913236616173`*^9, 
   3.7005913651984634`*^9}, {3.718553443172576*^9, 3.7185534672189755`*^9}, 
   3.7187124757342033`*^9, 3.7239143055452538`*^9, 3.7240083218584943`*^9, {
   3.7240197868324537`*^9, 3.7240197985070095`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"806fc017-8f33-4fa1-8211-ba13b3892310"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables Definitions", "Subsection",
 CellChangeTimes->{{3.5359999768587947`*^9, 3.5359999836951857`*^9}, {
   3.5764996882111*^9, 3.576499694551109*^9}, 
   3.5765000569766483`*^9},ExpressionUUID->"27136e79-c828-485c-9826-\
a8523c63a722"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Non", "-", 
    RowBox[{"Predetermined", " ", "Variables"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"yvarsp", "=", 
     RowBox[{"{", 
      RowBox[{"cp", ",", "zp"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yvars", "=", 
     RowBox[{"{", 
      RowBox[{"c", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yfuns", "=", 
     RowBox[{"{", 
      RowBox[{"cfun", ",", "zfun"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yvarss", "=", 
     RowBox[{"{", 
      RowBox[{"css", ",", "zss"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yvarssval", "=", 
     RowBox[{"{", 
      RowBox[{"cssval", ",", "zssval"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Predetermined", " ", "Variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xvars", "=", 
     RowBox[{"{", 
      RowBox[{"k", ",", "\[Eta]1", ",", "\[Eta]2"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xlag", "=", 
     RowBox[{"{", 
      RowBox[{"klag", ",", "\[Eta]1lag", ",", "\[Eta]2lag"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xfuns", "=", 
     RowBox[{"{", 
      RowBox[{"kfun", ",", "\[Eta]1fun", ",", "\[Eta]2fun"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xvarss", "=", 
     RowBox[{"{", 
      RowBox[{"kss", ",", "\[Eta]1ss", ",", "\[Eta]2ss"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xvarssval", "=", 
     RowBox[{"{", 
      RowBox[{"kssval", ",", "\[Eta]1ssval", ",", "\[Eta]2ssval"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Shocks", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"epsp", "=", 
     RowBox[{"{", "\[Epsilon]p", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eps", "=", 
     RowBox[{"{", "\[Epsilon]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Markov", " ", "Switching", " ", "Variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tvarsp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "sp", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "sp", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tvars", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "s", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "s", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tvarspss", "=", 
     RowBox[{"{", 
      RowBox[{"\[Mu]bar", ",", 
       RowBox[{"\[Sigma]", "[", "sp", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tvarss", "=", 
     RowBox[{"{", 
      RowBox[{"\[Mu]bar", ",", 
       RowBox[{"\[Sigma]", "[", "s", "]"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.576499891656398*^9, 3.576500003176573*^9}, 
   3.5765000569766483`*^9, 3.5765010194101195`*^9, {3.5765046809617567`*^9, 
   3.576504682121758*^9}, {3.576505456151792*^9, 3.576505486654341*^9}, {
   3.576505553684455*^9, 3.5765055765644875`*^9}, {3.577038045760437*^9, 
   3.57703804827044*^9}, {3.577038139390568*^9, 3.5770381398805685`*^9}, {
   3.5770381817031283`*^9, 3.57703820063067*^9}, {3.5771221501422386`*^9, 
   3.577122169992266*^9}, {3.5934379905838156`*^9, 3.5934380846441956`*^9}, {
   3.5934381294377575`*^9, 3.5934381663738704`*^9}, {3.6040805687078896`*^9, 
   3.6040805691239133`*^9}, {3.604080613979479*^9, 3.604080683947481*^9}, {
   3.6077044932731476`*^9, 3.6077044972333746`*^9}, {3.607704544801095*^9, 
   3.6077045458971577`*^9}, {3.60770462461666*^9, 3.607704626976795*^9}, {
   3.607704661953796*^9, 3.6077046936876106`*^9}, {3.607705056756377*^9, 
   3.6077050638777847`*^9}, {3.6077211525189705`*^9, 3.607721174510228*^9}, {
   3.607773489859482*^9, 3.6077735036432705`*^9}, 3.607773585332943*^9, {
   3.6077752027444534`*^9, 3.607775260806774*^9}, {3.6077766029545407`*^9, 
   3.607776607186783*^9}, {3.6077767651778193`*^9, 3.6077767967856274`*^9}, {
   3.6077768444493537`*^9, 3.6077768681207075`*^9}, {3.60777731592632*^9, 
   3.6077773416457915`*^9}, {3.6077776089160786`*^9, 3.6077776591159496`*^9}, 
   3.6077776926988707`*^9, {3.60777846266191*^9, 3.607778470741372*^9}, {
   3.607778508101509*^9, 3.607778509309578*^9}, {3.607778565733805*^9, 
   3.6077785774854774`*^9}, {3.6077867237944193`*^9, 3.607786726401569*^9}, {
   3.6077871008079834`*^9, 3.6077871086954346`*^9}, {3.6078067908649845`*^9, 
   3.6078068103671*^9}, {3.6084116395280347`*^9, 3.608411686778101*^9}, {
   3.608413510674198*^9, 3.608413516719544*^9}, {3.608413589000678*^9, 
   3.6084135893646994`*^9}, {3.6084866794383907`*^9, 
   3.6084866998865595`*^9}, {3.608486776685952*^9, 3.6084867866375217`*^9}, {
   3.6084868564995174`*^9, 3.6084869000850105`*^9}, {3.608486996812543*^9, 
   3.6084870065881023`*^9}, {3.6084870431911955`*^9, 3.608487046492385*^9}, {
   3.608554394570922*^9, 3.6085544121769295`*^9}, {3.6085551476439953`*^9, 
   3.608555156026475*^9}, {3.608555322769012*^9, 3.608555326337216*^9}, {
   3.6088357607233095`*^9, 3.6088357801484203`*^9}, {3.6088359220185347`*^9, 
   3.6088359427877226`*^9}, {3.6088364081131315`*^9, 
   3.6088364387798853`*^9}, {3.6088982053791666`*^9, 
   3.6088982132356167`*^9}, {3.6088982657796216`*^9, 3.608898282555581*^9}, {
   3.6089968428728323`*^9, 3.608996862840975*^9}, {3.609007700201022*^9, 
   3.609007719624133*^9}, {3.609601719826563*^9, 3.609601834106099*^9}, {
   3.609601890882346*^9, 3.609601896784684*^9}, {3.6096019967584023`*^9, 
   3.609601998277489*^9}, {3.6096020708296385`*^9, 3.6096020870315657`*^9}, {
   3.609676892482709*^9, 3.6096769198427477`*^9}, {3.6096787703621616`*^9, 
   3.6096788251692953`*^9}, {3.609678950221447*^9, 3.6096789547647066`*^9}, {
   3.6100272677384396`*^9, 3.6100272677384396`*^9}, {3.610027357498565*^9, 
   3.610027357508565*^9}, {3.6265493239258213`*^9, 3.6265493239768214`*^9}, {
   3.6265493559178886`*^9, 3.6265493559578886`*^9}, {3.626550403339673*^9, 
   3.626550403369673*^9}, {3.626550520301965*^9, 3.6265505203719654`*^9}, {
   3.6265510135511875`*^9, 3.626551013661187*^9}, {3.6265518651792955`*^9, 
   3.626551866711298*^9}, {3.6339591815775614`*^9, 3.6339592591247764`*^9}, {
   3.633960032430638*^9, 3.6339600369606466`*^9}, {3.6340449906499376`*^9, 
   3.634045008976986*^9}, {3.6340451159521046`*^9, 3.6340451677920694`*^9}, {
   3.6340452341998672`*^9, 3.6340452374720545`*^9}, {3.634047391955373*^9, 
   3.634047395027377*^9}, 3.6340474331524305`*^9, {3.6340474862235055`*^9, 
   3.6340475160955486`*^9}, {3.634047876002057*^9, 3.6340478886820745`*^9}, {
   3.6340658206513195`*^9, 3.634065862635404*^9}, {3.634311941324374*^9, 
   3.63431194911582*^9}, {3.6404556078281403`*^9, 3.6404556662313085`*^9}, {
   3.6404577687349195`*^9, 3.64045776899492*^9}, {3.6429757451676836`*^9, 
   3.6429757773677287`*^9}, {3.6455435763378177`*^9, 
   3.6455435874178343`*^9}, {3.7004994674869046`*^9, 3.700499484839897*^9}, {
   3.7004999921189117`*^9, 3.7005000087908654`*^9}, {3.7005912927367105`*^9, 
   3.7005913179491887`*^9}, 3.718041565776557*^9, 3.718042894938199*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"bb17bcfa-2ead-43f4-b17c-d68d414069cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.549388834060892*^9, 
  3.5493888351169524`*^9}},ExpressionUUID->"16a70ecc-910c-4ccd-a5b0-\
d8f01212bcd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "States"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"state", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xlag", ",", "eps", ",", "\[Chi]"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statep", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xvars", ",", 
        RowBox[{"\[Chi]", "*", "epsp"}], ",", "\[Chi]"}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Function", " ", "Lists"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yfunlist", "=", 
     RowBox[{"Through", "[", 
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"yfuns", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", "__", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xfunlist", "=", 
     RowBox[{"Through", "[", 
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"xfuns", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", "__", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Define", " ", "Functions"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funrulei", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"yvars", "\[Rule]", 
          RowBox[{"Through", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"yfuns", ",", 
                RowBox[{"{", "s", "}"}]}], "]"}], "]"}], ",", "state"}], 
            "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Thread", "[", 
         RowBox[{"xvars", "\[Rule]", 
          RowBox[{"Through", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"xfuns", ",", 
                RowBox[{"{", "s", "}"}]}], "]"}], "]"}], ",", "state"}], 
            "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Thread", "[", 
         RowBox[{"tvars", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"tvarss", "+", 
            RowBox[{"\[Chi]", "*", 
             RowBox[{"(", 
              RowBox[{"tvars", "-", "tvarss"}], ")"}]}]}], ")"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funrulej", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"yvarsp", "\[Rule]", 
          RowBox[{"Through", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"yfuns", ",", 
                RowBox[{"{", "sp", "}"}]}], "]"}], "]"}], ",", "statep"}], 
            "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Thread", "[", 
         RowBox[{"tvarsp", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"tvarspss", "+", 
            RowBox[{"\[Chi]", "*", 
             RowBox[{"(", 
              RowBox[{"tvarsp", "-", "tvarspss"}], ")"}]}]}], ")"}]}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6084090394914484`*^9, 3.6084090522741795`*^9}, {
   3.608410282801562*^9, 3.608410289635953*^9}, {3.608410332476403*^9, 
   3.6084103480282927`*^9}, {3.6084104946836805`*^9, 
   3.6084105195771046`*^9}, {3.6084108166840982`*^9, 
   3.6084108292958193`*^9}, {3.608410974673135*^9, 3.6084110247079964`*^9}, 
   3.6084110789821005`*^9, {3.608411244063543*^9, 3.6084112820497155`*^9}, {
   3.6084116574180593`*^9, 3.6084117409481764`*^9}, 3.6084134930631914`*^9, {
   3.6084136175463114`*^9, 3.608413646495967*^9}, {3.608413823115069*^9, 
   3.608413876134102*^9}, {3.6084144921143336`*^9, 3.60841449536652*^9}, {
   3.6084153345345173`*^9, 3.6084153437640452`*^9}, {3.6096770800670266`*^9, 
   3.609677081567029*^9}, {3.6339592950638523`*^9, 3.633959368153034*^9}, {
   3.634045175914534*^9, 3.6340452182649565`*^9}, {3.6340452771203227`*^9, 
   3.6340452788804235`*^9}, {3.63404533056738*^9, 3.634045374904916*^9}, {
   3.6340454094888935`*^9, 3.634045436432435*^9}, {3.6340457465991755`*^9, 
   3.6340457665323153`*^9}, {3.6340473156972656`*^9, 
   3.6340473362242947`*^9}, {3.6340660774989243`*^9, 3.634066080993932*^9}, {
   3.6340672659277225`*^9, 3.6340672663577228`*^9}, {3.6343115988938556`*^9, 
   3.6343116079718685`*^9}, {3.6343119521579933`*^9, 3.634311976853406*^9}, {
   3.634326305411641*^9, 3.6343263160616617`*^9}, {3.7004995236391163`*^9, 
   3.70049952405514*^9}, 3.7187127005312557`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"ed5e6aff-4a1f-4b9f-a3d0-ad9f5ceafe72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ns", "=", "2"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "regimes"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ny", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "yvars", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nx", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "xvars", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ne", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "eps", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nt", "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "tvars", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", ":", " ", 
    RowBox[{"Should", " ", "Print", " ", "Zero"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"n", "-", "nx", "-", "ny"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5765000246866026`*^9, 3.5765001227917614`*^9}, {
   3.5768514957931385`*^9, 3.576851496203139*^9}, {3.5771223086224604`*^9, 
   3.5771223295924892`*^9}, {3.5771224365226393`*^9, 3.5771224444326506`*^9}, 
   3.5771225507327995`*^9, 3.593438172860241*^9, 3.609601880430749*^9, {
   3.6096021622458677`*^9, 3.6096021633329296`*^9}, 3.6096794740684047`*^9, 
   3.6339593485029945`*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"ab209a3f-25a7-4249-8328-01d6bacebe97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regimes", "Subsection",
 CellChangeTimes->{{3.5496299986305246`*^9, 3.549629999468572*^9}, 
   3.5765000569766483`*^9, {3.6040814085299244`*^9, 
   3.6040814097769957`*^9}},ExpressionUUID->"0b914011-95c6-4c98-bf58-\
0252d674ad3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pmat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"ii", ",", "jj"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "ns"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"jj", ",", "1", ",", "ns"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"probrule", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Flatten", "[", "Pmat", "]"}], ")"}], "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"p11", ",", 
       RowBox[{"1", "-", "p11"}], ",", 
       RowBox[{"1", "-", "p22"}], ",", "p22"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omegas", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "ii", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "ns"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omegarule", "=", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"omegas", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"1", "+", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "\[Eta]1"}], "]"}]}]], ",", 
        FractionBox["1", 
         RowBox[{"1", "+", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "\[Eta]2"}], "]"}]}]]}], "}"}]}], "]"}], "/.", 
    "funrulei"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pmat", "=", 
   RowBox[{"Pmat", "/.", "probrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omegas", "=", 
   RowBox[{"omegas", "/.", "omegarule"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.549630010509204*^9, 3.5496300980422106`*^9}, {
   3.5496302840118475`*^9, 3.549630286545992*^9}, {3.5496313149698143`*^9, 
   3.5496313164088964`*^9}, {3.549631569783389*^9, 3.54963157207952*^9}, {
   3.5496429523946824`*^9, 3.549643002473547*^9}, {3.549646264415119*^9, 
   3.549646335724198*^9}, 3.549646849827603*^9, {3.5497134558872995`*^9, 
   3.54971345606631*^9}, {3.5497137131240125`*^9, 3.549713714351083*^9}, {
   3.549713757885573*^9, 3.5497138258924627`*^9}, {3.5497139251901417`*^9, 
   3.549713926173198*^9}, {3.549714123920509*^9, 3.5497141259316235`*^9}, {
   3.560033131401148*^9, 3.5600331348043427`*^9}, {3.5600333073432117`*^9, 
   3.560033310620399*^9}, 3.5765000569766483`*^9, {3.576500129841771*^9, 
   3.5765001913218575`*^9}, {3.5772726286460094`*^9, 
   3.5772726361160192`*^9}, {3.5934424472293*^9, 3.593442461724129*^9}, 
   3.6096019553830357`*^9, {3.6096042959431562`*^9, 3.6096043322552333`*^9}, 
   3.6096043705514235`*^9, {3.6096044016452017`*^9, 3.609604405539425*^9}, {
   3.626550520381965*^9, 3.626550520391965*^9}, {3.6265510136711874`*^9, 
   3.626551013681187*^9}, {3.6272359473638573`*^9, 3.6272359549738717`*^9}, {
   3.6272360328130713`*^9, 3.6272360392390842`*^9}, {3.633959385756074*^9, 
   3.633959428885186*^9}, {3.634045841771619*^9, 3.6340458475069466`*^9}, {
   3.6340466526053267`*^9, 3.634046657045333*^9}, {3.634046791653522*^9, 
   3.6340469410487356`*^9}, {3.6340471191719875`*^9, 
   3.6340471244319954`*^9}, {3.634066236025358*^9, 3.6340662709484663`*^9}, {
   3.6340663166555567`*^9, 3.634066318772561*^9}, 3.642975854778837*^9, {
   3.700500013511135*^9, 3.7005000166953173`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"897e032b-e1c5-4a17-a227-b5a37f85f555"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ss", "=", "1"}], ",", 
    RowBox[{"ss", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ss", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"F", ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"omegas", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"Pmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "f"}], "/.", 
                "probrule"}], "/.", "funrulej"}], "/.", "funrulei"}], "/.", 
             RowBox[{"s", "\[Rule]", "ss"}]}], "/.", 
            RowBox[{"sp", "\[Rule]", "j"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "ns"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "ns"}], "}"}]}], "]"}]}], "}"}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.608414307009746*^9, 3.608414422526353*^9}, {
   3.608414507812231*^9, 3.608414507941239*^9}, {3.608414600592538*^9, 
   3.6084146025746517`*^9}, {3.609601962639451*^9, 3.6096019674867277`*^9}, {
   3.6097758642534857`*^9, 3.6097759138283205`*^9}, 3.6097760476919775`*^9, {
   3.6098539300319843`*^9, 3.6098539309420366`*^9}, {3.6272276167742467`*^9, 
   3.627227735876416*^9}, {3.6272323795087004`*^9, 3.6272323816587048`*^9}, {
   3.6272324510938964`*^9, 3.627232451713897*^9}, {3.633959355430009*^9, 
   3.6339593828260665`*^9}, {3.633959438415208*^9, 3.633959443891219*^9}, {
   3.634045861459745*^9, 3.6340458617637625`*^9}, {3.6340460590492735`*^9, 
   3.6340461473394823`*^9}, {3.634046669877351*^9, 3.634046701380395*^9}, {
   3.6340469210387077`*^9, 3.634046928788718*^9}, {3.63404697991579*^9, 
   3.6340470861459413`*^9}, {3.634047273285206*^9, 3.6340472752852087`*^9}, {
   3.63404789271208*^9, 3.634047903242095*^9}, {3.63404801345925*^9, 
   3.634048029052273*^9}, {3.6340538341830096`*^9, 3.6340538356990137`*^9}, {
   3.634053977507408*^9, 3.6340539812374163`*^9}, {3.634066022999796*^9, 
   3.6340660249198003`*^9}, {3.634066953796282*^9, 3.6340669776483154`*^9}, {
   3.6340673083627825`*^9, 3.6340673090827837`*^9}, {3.634316853712671*^9, 
   3.6343168549127393`*^9}, 3.6343265051331263`*^9, {3.6404566753720303`*^9, 
   3.640456678702035*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"f84d881c-f36a-4740-85e9-a61490788d02"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Steady State", "Section",
 CellChangeTimes->{{3.6339594897533135`*^9, 
  3.6339594911303167`*^9}},ExpressionUUID->"796d0cbd-bdba-4f6b-990e-\
e12d16175788"],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.6339596564007053`*^9, 
  3.633959657717708*^9}},ExpressionUUID->"0619cc58-1c1e-4bd4-aa12-\
9782b0f12646"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parmrule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "\[Rule]", "0.99722"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "\[Rule]", "0.28"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", "\[Rule]", "0.025"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]bar", "\[Rule]", 
      FractionBox["1.3277", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]bar", "\[Rule]", 
      FractionBox["3.1448", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"p11", "\[Rule]", "0.98"}], ",", "\[IndentingNewLine]", 
     RowBox[{"p22", "\[Rule]", "0.98"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "1", "]"}], "\[Rule]", 
      FractionBox["0.712011", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "2", "]"}], "\[Rule]", 
      FractionBox["1.94348", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "1", "]"}], "\[Rule]", 
      FractionBox["2.52795", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "2", "]"}], "\[Rule]", " ", 
      FractionBox["3.76156", "400"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"filename", "\[Rule]", "\"\<rbc_example_approach2\>\""}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6339596591377106`*^9, 3.6339596955068197`*^9}, {
   3.633959732379898*^9, 3.633959752991946*^9}, {3.633960070120716*^9, 
   3.6339600859247494`*^9}, {3.6404557209494777`*^9, 3.640455741478532*^9}, {
   3.640457894161295*^9, 3.6404578954312973`*^9}, {3.6404579576084847`*^9, 
   3.6404579586384873`*^9}, {3.6406256253638687`*^9, 3.640625626307923*^9}, 
   3.6455436010378532`*^9, {3.6712950710525775`*^9, 3.6712950776845984`*^9}, {
   3.6714013814184484`*^9, 3.6714013875467987`*^9}, 3.6714014260910034`*^9, {
   3.7005912178851967`*^9, 3.700591262982686*^9}, {3.7009994351415834`*^9, 
   3.7009994360775833`*^9}, {3.718041587072858*^9, 3.7180415897921734`*^9}, {
   3.718042229092785*^9, 3.718042263726473*^9}, {3.7180423087275553`*^9, 
   3.718042309567314*^9}, {3.7180428613372917`*^9, 3.7180428626723847`*^9}, {
   3.718042901169967*^9, 3.7180429018984265`*^9}, {3.718042942739792*^9, 
   3.718042943268216*^9}, {3.7180430587954035`*^9, 3.71804305941921*^9}, {
   3.718193210928214*^9, 3.7181932168890576`*^9}, {3.7181934031521344`*^9, 
   3.718193403584283*^9}, {3.718552105800911*^9, 3.7185521101929245`*^9}, {
   3.7185523003611994`*^9, 3.7185523058804655`*^9}, {3.7185524766570096`*^9, 
   3.718552483352696*^9}, {3.71855339858014*^9, 3.718553400135333*^9}, {
   3.7185536576347127`*^9, 3.718553658122449*^9}, {3.7186255785156555`*^9, 
   3.7186255845546823`*^9}, 3.718712516879835*^9, {3.7187126113046274`*^9, 
   3.718712614617525*^9}, {3.718712745584524*^9, 3.7187127456783004`*^9}, {
   3.7236699205501204`*^9, 3.723669923200161*^9}, {3.7240059475005765`*^9, 
   3.724005958307045*^9}, {3.724008337880825*^9, 3.724008358029351*^9}, 
   3.7240085483918*^9, 3.724008801470499*^9, 3.724017000115323*^9, {
   3.724019803211194*^9, 3.7240198045863123`*^9}, 3.7247695313549623`*^9, 
   3.7247695725378504`*^9, 3.7367676524264812`*^9, {3.738722400707829*^9, 
   3.7387224045364013`*^9}, {3.7390257642707667`*^9, 3.7390257719245195`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"3dbfc93e-032c-4073-916b-fbf92413f300"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rules", "Subsection",
 CellChangeTimes->{{3.6339595387094145`*^9, 
  3.6339595391994147`*^9}},ExpressionUUID->"9ed7bf17-e6c4-4bbc-a56b-\
49f9651f8340"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"derivrule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "__", "]"}], "[", "_", "]"}], "[", "__", 
       "]"}]}], "\[RuleDelayed]", "\[VeryThinSpace]", 
     RowBox[{"d", "[", 
      RowBox[{"[", "0", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ssrule", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]", "\[Rule]", "0"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"xlag", "\[Rule]", "xvarss"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"xfunlist", "\[Rule]", "xvarss"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"yfunlist", "\[Rule]", "yvarss"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsrule", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"eps", "\[Rule]", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsprule1", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"epsp", "\[Rule]", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsprule2", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     SuperscriptBox["epsp", "2"], "\[Rule]", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ssvalrule", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xvarss", ",", "yvarss"}], "}"}], "]"}], "\[Rule]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xvarssval", ",", "yvarssval"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.63395949264032*^9, 3.6339595222303805`*^9}, 
   3.6339596303316517`*^9, {3.6339596996938286`*^9, 3.6339597085868464`*^9}, {
   3.6340474061373925`*^9, 3.6340474155074053`*^9}, {3.6340474583614664`*^9, 
   3.6340474634714737`*^9}, {3.6340660930069575`*^9, 
   3.6340660971469655`*^9}, {3.738722409802538*^9, 3.738722410380723*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"e145df58-fa44-4d91-8d65-96868f17b9eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Steady State", "Subsection",
 CellChangeTimes->{{3.6339595327294025`*^9, 3.6339595363294096`*^9}, {
  3.7185521713550906`*^9, 
  3.7185521723805513`*^9}},ExpressionUUID->"1b9fa631-7685-45dc-9432-\
3ec1731925bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zssval", "=", "\[Mu]bar"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kssval", "=", 
   RowBox[{"Log", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"\[Alpha]", "*", 
         RowBox[{"Exp", "[", "\[Mu]bar", "]"}]}]], "*", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"\[Beta]", "*", 
           SuperscriptBox[
            RowBox[{"Exp", "[", "\[Mu]bar", "]"}], 
            FractionBox[
             RowBox[{"-", "1"}], 
             RowBox[{"1", "-", "\[Alpha]"}]]]}]], "-", "1", "+", "\[Delta]"}],
         ")"}]}], ")"}], 
     FractionBox["1", 
      RowBox[{"\[Alpha]", "-", "1"}]]], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cssval", "=", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", "\[Mu]bar", "]"}], "*", 
      SuperscriptBox[
       RowBox[{"Exp", "[", "kssval", "]"}], "\[Alpha]"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Delta]", "-", 
        SuperscriptBox[
         RowBox[{"Exp", "[", "\[Mu]bar", "]"}], 
         FractionBox["1", 
          RowBox[{"1", "-", "\[Alpha]"}]]]}], ")"}], "*", 
      RowBox[{"Exp", "[", "kssval", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sssoln", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"NSolve", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], "/.", "ssrule"}], "/.",
             "ssvalrule"}], "/.", "epsrule"}], "/.", "parmrule"}], ")"}], 
        "\[Equal]", "0"}], "]"}], ",", "Reals"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sssoln", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"sssoln", "//", "Dimensions"}]}], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"5c2f4fc9-ef75-4977-b8d6-3d1602bf9208"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Eta]1ssval", "=", 
   RowBox[{"\[Eta]1ssval", "/.", 
    RowBox[{"sssoln", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]2ssval", "=", 
   RowBox[{"\[Eta]2ssval", "/.", 
    RowBox[{"sssoln", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"2d903dd3-995a-4bc1-9b86-1e218e620404"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Steady State Values", "Subsection",
 CellChangeTimes->{{3.6339595796525483`*^9, 
  3.6339595833025556`*^9}},ExpressionUUID->"3c7dfec6-41aa-4f4e-b0bf-\
99af4861fb17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"F", "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}],
      "/.", "epsrule"}], "/.", "epsprule1"}], "//", "Simplify"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xvarss", "=", 
   RowBox[{
    RowBox[{"xvarss", "/.", "ssvalrule"}], "/.", "parmrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yvarss", "=", 
   RowBox[{
    RowBox[{"yvarss", "/.", "ssvalrule"}], "/.", "parmrule"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.633959572295533*^9, 3.633959633157658*^9}, {
  3.6339597113568525`*^9, 3.633959726192885*^9}, {3.6339597688959785`*^9, 
  3.6339598101950927`*^9}, {3.6340471960260973`*^9, 3.634047200646104*^9}, {
  3.6340473458343077`*^9, 3.6340473478743105`*^9}, {3.6712950567725277`*^9, 
  3.671295065073557*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"78d591f9-e445-4e3a-888d-13e2102fe4d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check", "Subsection",
 CellChangeTimes->{{3.6712894919236946`*^9, 3.671289493238699*^9}, {
  3.671290479215686*^9, 
  3.671290480971692*^9}},ExpressionUUID->"24a41a51-d9ad-4f6d-8d8a-\
78de21934b46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"normcheck", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normcheck", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "=", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"F", "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], 
    "/.", "epsrule"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.671289495140706*^9, 3.6712895262258925`*^9}, 
   3.718712551479144*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"ea34e48e-d33e-483c-b244-7a0ed4c59f50"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["First Order Approximation", "Section",
 CellChangeTimes->{{3.6339598205711174`*^9, 
  3.633959825021128*^9}},ExpressionUUID->"3579105a-59d2-49a6-98fe-\
4d7516660439"],

Cell[CellGroupData[{

Cell["Matrices", "Subsection",
 CellChangeTimes->{{3.6339601061357975`*^9, 
  3.6339601075257998`*^9}},ExpressionUUID->"18db7b3b-edb5-4e0f-b487-\
faa0a03f1f87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yvars", "/.", "funrulei"}], ",", 
          RowBox[{"{", "state", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
       RowBox[{"s", "\[Rule]", "ii"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"xvars", "/.", "funrulei"}], ",", 
          RowBox[{"{", "state", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
       RowBox[{"s", "\[Rule]", "ii"}]}]}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.633960110095804*^9, 3.6339601638149366`*^9}, {
   3.634304627903549*^9, 3.634304629174622*^9}, 3.6343046833577213`*^9, {
   3.6343170149368925`*^9, 3.634317015391918*^9}, 3.634326327837685*^9},
 CellLabel->"In[71]:=",ExpressionUUID->"de2f8f75-6b43-4a5f-b5ab-3587a2e9c7c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative for x", "Subsection",
 CellChangeTimes->{{3.6339598291911397`*^9, 
  3.6339598311171436`*^9}},ExpressionUUID->"522bf290-b69f-46af-965d-\
331c71f8b24a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dFx", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"F", ",", 
            RowBox[{"{", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "xlag", "}"}], "]"}], "}"}]}], "]"}], "/.", 
          "derivrule"}], "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", 
       "epsrule"}], "/.", "epsprule1"}], "/.", "parmrule"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"soln", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Flatten", "[", "dFx", "]"}], ")"}], "\[Equal]", "0"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"soln", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6339598343581514`*^9, 3.6339599110193577`*^9}, {
  3.6340540293715153`*^9, 3.6340541167367563`*^9}, {3.634054426207021*^9, 
  3.634054434687033*^9}, {3.6340544799061003`*^9, 3.6340545091501417`*^9}, {
  3.634054620911306*^9, 3.6340546477323456`*^9}, {3.634055884716631*^9, 
  3.634055909388666*^9}, {3.6340665376111116`*^9, 3.634066539938117*^9}, {
  3.6340670467144136`*^9, 3.634067048904417*^9}, {3.634306452417906*^9, 
  3.6343064745131693`*^9}, {3.6343066137597055`*^9, 3.6343066393567414`*^9}, {
  3.6343066726667995`*^9, 3.6343067842359624`*^9}, {3.634308924097271*^9, 
  3.634308935648932*^9}, {3.634309113327636*^9, 3.634309114662712*^9}, {
  3.6343092123102975`*^9, 3.634309212797325*^9}, {3.6343092683622956`*^9, 
  3.6343093136283593`*^9}, {3.6343168784800873`*^9, 3.634316921247534*^9}, {
  3.634324982583508*^9, 3.634324993893531*^9}, {3.6404572465206575`*^9, 
  3.640457249826666*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"ee903fb2-3fcc-45bc-882d-45dda8741755"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check for MSS", "Subsection",
 CellChangeTimes->{{3.640024608975321*^9, 
  3.6400246113553267`*^9}},ExpressionUUID->"73f5bd09-c370-4ab9-a130-\
dc6647ecc365"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"count", "=", "0"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "MSS", " ", "Solutions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "MSS", " ", "of", " ", "each", " ", "soln"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solution", "=", 
    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Construct", " ", "T", " ", "matrix"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalUpsilon]", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nx", "2"], "*", "ns"}], ",", 
       RowBox[{
        SuperscriptBox["nx", "2"], "*", "ns"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalUpsilon]", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ii", "-", "1"}], ")"}], "*", 
           SuperscriptBox["nx", "2"]}], "+", "1"}], ";;", 
         RowBox[{"ii", "*", 
          SuperscriptBox["nx", "2"]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ii", "-", "1"}], ")"}], "*", 
           SuperscriptBox["nx", "2"]}], "+", "1"}], ";;", 
         RowBox[{"ii", "*", 
          SuperscriptBox["nx", "2"]}]}]}], "]"}], "]"}], "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"H", "[", "ii", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "nx"}], ",", 
          RowBox[{"1", ";;", "nx"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"H", "[", "ii", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "nx"}], ",", 
          RowBox[{"1", ";;", "nx"}]}], "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tmat", "=", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "Pmat", "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", 
        SuperscriptBox["nx", "2"], "]"}]}], "]"}], ".", 
     "\[CapitalUpsilon]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "Eigenvalues", " ", "of", " ", "T"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", 
     RowBox[{
      RowBox[{"Dimensions", "[", "soln", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"Max", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{
          RowBox[{"Tmat", "/.", "parmrule"}], "/.", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}], "]"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"Eigenvalues", "[", 
           RowBox[{
            RowBox[{"Tmat", "/.", "parmrule"}], "/.", 
            RowBox[{"soln", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}], "]"}], "<", 
        "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "MSS"}], ",", " ", 
         RowBox[{
         "increment", " ", "count", " ", "and", " ", "save", " ", "as", " ", 
          "solution"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"count", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"solution", "=", 
         RowBox[{"soln", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"count", "//", "Print"}], "\[IndentingNewLine]", 
 RowBox[{"solution", "//", "Print"}]}], "Input",
 CellChangeTimes->{{3.640024614325334*^9, 3.6400246768855286`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"5a4e2d4c-d8d3-4e20-a0b6-18f3966508cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative for \[Epsilon]", "Subsection",
 CellChangeTimes->{{3.6339599150693665`*^9, 3.6339599207093773`*^9}, {
   3.643043350557083*^9, 3.643043352147085*^9}, 
   3.6455436420590296`*^9},ExpressionUUID->"68bf6d6c-2c31-4e85-9f3e-\
8fc7bf080a87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dF\[Epsilon]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"F", ",", 
           RowBox[{"{", "eps", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
        "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], "/.", 
     "solution"}], "/.", "epsrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"solution", ",", 
      RowBox[{"Solve", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{"dF\[Epsilon]", "\[Equal]", "0"}], "]"}], "]"}]}], "}"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.633959928411392*^9, 3.6339599808755093`*^9}, {
  3.634055947280719*^9, 3.6340559597207365`*^9}, {3.6340670644144387`*^9, 
  3.6340670913264766`*^9}, {3.640457917984355*^9, 3.640457933166396*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"6e711b7a-5c2d-4a45-a95e-16aff609dfdf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative for \[Chi]", "Subsection",
 CellChangeTimes->{{3.6339599150693665`*^9, 3.6339599207093773`*^9}, {
  3.6339599873015223`*^9, 
  3.6339599895315266`*^9}},ExpressionUUID->"bcb74071-d191-4463-bfb1-\
28f05b1e5115"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dF\[Chi]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"F", ",", 
            RowBox[{"{", "\[Chi]", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
         "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], "/.", 
      "epsrule"}], "/.", "epsprule1"}], "/.", "solution"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"solution", ",", 
      RowBox[{"Solve", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{"dF\[Chi]", "\[Equal]", "0"}], "]"}], "]"}]}], "}"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.633959928411392*^9, 3.633959997538543*^9}, {
  3.63396005281668*^9, 3.633960056626687*^9}, {3.6340559842577734`*^9, 
  3.6340560045578017`*^9}, {3.634067104646495*^9, 3.6340671062464976`*^9}, {
  3.640457920831361*^9, 3.640457944028427*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"63b98d0c-c2c5-4409-ac55-9502172c8f33"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check Accuracy", "Subsection",
 CellChangeTimes->{{3.671289338092142*^9, 
  3.671289340019149*^9}},ExpressionUUID->"414b568e-ed65-4872-8981-\
ef2ac476e885"],

Cell[BoxData[
 RowBox[{
  RowBox[{"normcheck", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "=", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"F", ",", 
            RowBox[{"{", "state", "}"}]}], "]"}], "/.", "derivrule"}], "/.", 
         "ssrule"}], "/.", "ssvalrule"}], "/.", "parmrule"}], "/.", 
      "solution"}], "/.", "epsprule1"}], "/.", "epsrule"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6712893409271526`*^9, 3.6712893819092865`*^9}, {
   3.6712895640110188`*^9, 3.6712895942061605`*^9}, {3.6712896436073203`*^9, 
   3.671289676141431*^9}, 3.718712560047744*^9, {3.7187126391837864`*^9, 
   3.718712641090225*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"8b86a9ae-ac52-42cc-941d-2f5ff1c3604f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrices", "Subsection",
 CellChangeTimes->{{3.6339601061357975`*^9, 
  3.6339601075257998`*^9}},ExpressionUUID->"36cc6f69-9ce9-4b9a-848a-\
a7f7f4980f90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{"G", "[", "ii", "]"}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{"H", "[", "ii", "]"}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"G", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"H", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.633960110095804*^9, 3.6339601638149366`*^9}, {
   3.63406714385855*^9, 3.6340671745925937`*^9}, {3.634309249097268*^9, 
   3.6343092546372757`*^9}, {3.640457921570363*^9, 3.6404579224313655`*^9}, 
   3.645543681249087*^9, {3.700499584032571*^9, 3.700499592871076*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"cfd04a85-ff53-45c8-9a68-19b8d60d4d78"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Second Order Perturbation", "Section",
 CellChangeTimes->{{3.5497122872214556`*^9, 
  3.5497122923997517`*^9}},ExpressionUUID->"c5226f17-ed32-4c47-b383-\
3ceb3ffd008e"],

Cell[CellGroupData[{

Cell["Taking Derivatives", "Subsection",
 CellChangeTimes->{{3.5360061098685827`*^9, 3.5360061175960245`*^9}, {
  3.549712322283461*^9, 
  3.549712324832607*^9}},ExpressionUUID->"14f13d70-df17-419e-8594-\
8803c8fe353e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d2Fss", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", 
     RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "ii"}], ",", 
       RowBox[{"jj", "\[LessEqual]", 
        RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2Fss", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"d2Fss", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"F", ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "}"}]}], "]"}], "/.", 
                  "derivrule"}], "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", 
               "epsrule"}], "/.", "parmrule"}], "/.", "solution"}]}], "}"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.537299978328273*^9, 3.537299997175351*^9}, {
   3.537300083073264*^9, 3.5373000862864475`*^9}, {3.537300163827883*^9, 
   3.5373001732244205`*^9}, {3.5373003107722874`*^9, 
   3.5373003168296337`*^9}, {3.5373003935210204`*^9, 
   3.5373004184064436`*^9}, {3.537300452350385*^9, 3.5373004560755987`*^9}, {
   3.53730057114118*^9, 3.537300634153784*^9}, {3.537301478644086*^9, 
   3.537301485445475*^9}, {3.5434220185638*^9, 3.5434220187398*^9}, {
   3.5435781071776013`*^9, 3.543578107377613*^9}, {3.544187785762565*^9, 
   3.5441877859455757`*^9}, {3.5441887901490126`*^9, 
   3.5441887903490243`*^9}, {3.5442791108333244`*^9, 
   3.5442791141095114`*^9}, {3.549712615232217*^9, 3.549712615678242*^9}, {
   3.6156481997036157`*^9, 3.6156481998796253`*^9}, {3.6401057397408013`*^9, 
   3.640105740040802*^9}, {3.6404521792490096`*^9, 3.6404521911990385`*^9}, {
   3.640544796590741*^9, 3.6405447968207417`*^9}, 3.641049403027667*^9, {
   3.6410494444920387`*^9, 3.6410494457391095`*^9}, {3.641049483227254*^9, 
   3.641049483595275*^9}, {3.641049529506901*^9, 3.6410495298909225`*^9}, {
   3.643043852932678*^9, 3.643043854090684*^9}, {3.6430439983602304`*^9, 
   3.643044001917242*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"1dfec160-e070-4188-ab63-5dd1f7fc09c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expectations of Future Shocks", "Subsection",
 CellChangeTimes->{{3.5497123305569344`*^9, 
  3.5497123432656612`*^9}},ExpressionUUID->"0a6b2ea4-feb4-4c40-b54d-\
6d7a52225d8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"E0", ",", "E1", ",", "E2"}], "}"}], "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"d2Fss", ",", "epsp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2Fss", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", "E0", "]"}], "+", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "E2", "]"}], ".", "epsp", ".", "epsp"}], 
        "]"}]}], "/.", "epsprule2"}], "/.", "epsprule1"}], "/.", 
    "epsrule"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5369487634414787`*^9, 3.5369488100481443`*^9}, {
   3.5369488943369656`*^9, 3.5369489014713736`*^9}, {3.536949133624652*^9, 
   3.536949140994074*^9}, {3.536951585376768*^9, 3.536951592646381*^9}, 
   3.537301741329111*^9, {3.5373019012662587`*^9, 3.5373019028413486`*^9}, 
   3.543244502227271*^9, 3.5432447490863905`*^9, {3.543245043350221*^9, 
   3.543245044749301*^9}, {3.5432453262013993`*^9, 3.5432453314847016`*^9}, 
   3.5432456069484572`*^9, {3.543245724396175*^9, 3.543245729471465*^9}, 
   3.543246052774957*^9, {3.5434220218898*^9, 3.5434220220338*^9}, {
   3.5435781082076607`*^9, 3.5435781083996716`*^9}, {3.54418778846472*^9, 
   3.5441877886487303`*^9}, {3.544188792842167*^9, 3.5441887930241776`*^9}, {
   3.5442791146195407`*^9, 3.5442791160976257`*^9}, 3.549712493047228*^9, {
   3.6430438100985355`*^9, 3.643043812008541*^9}, {3.6430440418653727`*^9, 
   3.6430440422543755`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"70e4107a-a9cd-4572-a2b7-e37fcd7b1950"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving Linear System", "Subsection",
 CellChangeTimes->{{3.549712347193886*^9, 
  3.5497123502800627`*^9}},ExpressionUUID->"c7014206-e2cc-4aa5-a082-\
2f52592a9955"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Variables", "[", "d2Fss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"NN", ",", "MM"}], "}"}], "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"d2Fss", ",", "vars"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"solution", ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"vars", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Inverse", "[", "MM", "]"}], ".", "NN"}]}], ")"}]}], 
       "]"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5369283351621113`*^9, 3.5369283655028467`*^9}, {
  3.53692840122289*^9, 3.536928477952279*^9}, {3.536928545021115*^9, 
  3.5369285908757377`*^9}, {3.5369289031856008`*^9, 3.536928948024165*^9}, {
  3.5434220240978003`*^9, 3.5434220242578*^9}, {3.5435781090947113`*^9, 
  3.543578109334725*^9}, {3.5441877912068768`*^9, 3.544187791366886*^9}, {
  3.544188795895342*^9, 3.5441887960943527`*^9}, {3.5442791171206837`*^9, 
  3.5442791192468057`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"ba63c3fd-1541-4ccb-8c26-58163ab8dbf4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check Accuracy", "Subsection",
 CellChangeTimes->{{3.6712896946964912`*^9, 
  3.6712897012435565`*^9}},ExpressionUUID->"ccc72439-dfe4-432d-9785-\
da5299c28913"],

Cell[BoxData[
 RowBox[{
  RowBox[{"normcheck", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "=", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"F", ",", 
               RowBox[{"{", 
                RowBox[{"state", ",", "2"}], "}"}]}], "]"}], "/.", 
             "derivrule"}], "/.", "ssrule"}], "/.", "ssvalrule"}], "/.", 
          "parmrule"}], "/.", "solution"}], "/.", "epsrule"}], "]"}], "]"}], "/.",
      "epsprule2"}], "/.", "epsprule1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6712897026725626`*^9, 3.6712897896489286`*^9}, {
   3.6712899073233624`*^9, 3.6712899138883877`*^9}, {3.671289948607499*^9, 
   3.6712899509955063`*^9}, 3.671289991208688*^9, {3.671290053576893*^9, 
   3.6712900589029107`*^9}, {3.7180417767272663`*^9, 3.7180417880953536`*^9}, 
   3.7185524110442095`*^9, 3.7187125640171757`*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"393632c3-0b26-4449-96d1-6c38a7866887"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Saving Solution", "Subsection",
 CellChangeTimes->{{3.5360044033569756`*^9, 
  3.5360044090172997`*^9}},ExpressionUUID->"f1039c50-b760-4733-9517-\
bbaff9cfa20f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G2", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"yvars", "/.", "funrulei"}], ",", 
           RowBox[{"{", 
            RowBox[{"state", ",", "2"}], "}"}]}], "]"}], "/.", "derivrule"}], 
        "/.", 
        RowBox[{"s", "\[Rule]", "ii"}]}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G2", "[", "ii", "]"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"G2", "[", "ii", "]"}], "]"}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"nx", "+", "ne", "+", "1"}], ")"}], "2"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H2", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"xvars", "/.", "funrulei"}], ",", 
           RowBox[{"{", 
            RowBox[{"state", ",", "2"}], "}"}]}], "]"}], "/.", "derivrule"}], 
        "/.", 
        RowBox[{"s", "\[Rule]", "ii"}]}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H2", "[", "ii", "]"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"H2", "[", "ii", "]"}], "]"}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"nx", "+", "ne", "+", "1"}], ")"}], "2"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"G2", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"H2", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.536004455513959*^9, 3.536004467257631*^9}, {
   3.536004644196751*^9, 3.536004644668778*^9}, {3.536004787317937*^9, 
   3.536004857026924*^9}, {3.5360053244116573`*^9, 3.536005324971689*^9}, {
   3.536005462369548*^9, 3.536005577646141*^9}, 3.536005611583082*^9, {
   3.5360056512653522`*^9, 3.536005652295411*^9}, {3.536005708824644*^9, 
   3.536005738658351*^9}, {3.536005827619439*^9, 3.5360058838716564`*^9}, {
   3.536006084104109*^9, 3.536006088804378*^9}, {3.549712742721509*^9, 
   3.549712744719623*^9}, {3.61565529099061*^9, 3.615655292573701*^9}, {
   3.6401057315107813`*^9, 3.6401057347307887`*^9}, {3.643046654887161*^9, 
   3.643046686536207*^9}, {3.6430467430632906`*^9, 3.6430467447942934`*^9}, {
   3.700499607199896*^9, 3.7004996073739057`*^9}, {3.70049967702989*^9, 
   3.70049967739091*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"2c81fe3a-4e2b-4b3c-98ce-0a16c8273a27"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Third Order Perturbation", "Section",
 CellChangeTimes->{{3.5497122872214556`*^9, 3.5497122923997517`*^9}, {
  3.7004996895186043`*^9, 
  3.700499690757675*^9}},ExpressionUUID->"05b766e8-a1ff-4a89-9ba2-\
151950a8814c"],

Cell[CellGroupData[{

Cell["Taking Derivatives", "Subsection",
 CellChangeTimes->{{3.5360061098685827`*^9, 3.5360061175960245`*^9}, {
  3.549712322283461*^9, 
  3.549712324832607*^9}},ExpressionUUID->"95a418f5-8658-4b13-80fe-\
7175fd4572f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d3Fss", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", 
     RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "ii"}], ",", 
       RowBox[{"jj", "\[LessEqual]", 
        RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"kk", "=", "jj"}], ",", 
          RowBox[{"kk", "\[LessEqual]", 
           RowBox[{"nx", "+", "ne", "+", "1"}]}], ",", 
          RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"d3Fss", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"d3Fss", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"F", ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], "}"}]}], "]"}], "/.", 
                    "derivrule"}], "/.", "ssrule"}], "/.", "ssvalrule"}], "/.",
                   "epsrule"}], "/.", "parmrule"}], "/.", "solution"}]}], 
              "}"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.537299978328273*^9, 3.537299997175351*^9}, {
   3.537300083073264*^9, 3.5373000862864475`*^9}, {3.537300163827883*^9, 
   3.5373001732244205`*^9}, {3.5373003107722874`*^9, 
   3.5373003168296337`*^9}, {3.5373003935210204`*^9, 
   3.5373004184064436`*^9}, {3.537300452350385*^9, 3.5373004560755987`*^9}, {
   3.53730057114118*^9, 3.537300634153784*^9}, {3.537301478644086*^9, 
   3.537301485445475*^9}, {3.5434220185638*^9, 3.5434220187398*^9}, {
   3.5435781071776013`*^9, 3.543578107377613*^9}, {3.544187785762565*^9, 
   3.5441877859455757`*^9}, {3.5441887901490126`*^9, 
   3.5441887903490243`*^9}, {3.5442791108333244`*^9, 
   3.5442791141095114`*^9}, {3.549712615232217*^9, 3.549712615678242*^9}, {
   3.6156481997036157`*^9, 3.6156481998796253`*^9}, {3.6401057397408013`*^9, 
   3.640105740040802*^9}, {3.6404521792490096`*^9, 3.6404521911990385`*^9}, {
   3.640544796590741*^9, 3.6405447968207417`*^9}, 3.641049403027667*^9, {
   3.6410494444920387`*^9, 3.6410494457391095`*^9}, {3.641049483227254*^9, 
   3.641049483595275*^9}, {3.641049529506901*^9, 3.6410495298909225`*^9}, {
   3.643043852932678*^9, 3.643043854090684*^9}, {3.6430439983602304`*^9, 
   3.643044001917242*^9}, {3.694347075449092*^9, 3.6943471116109147`*^9}, {
   3.6943471973405557`*^9, 3.694347198151289*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"0c155c32-c907-459a-8929-9ac8cbc3c9a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expectations of Future Shocks", "Subsection",
 CellChangeTimes->{{3.5497123305569344`*^9, 
  3.5497123432656612`*^9}},ExpressionUUID->"ea91209d-0869-4373-9634-\
180db17bfc61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"E0", ",", "E1", ",", "E2", ",", "E3"}], "}"}], "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"d3Fss", ",", "epsp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d3Fss", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", "E0", "]"}], "+", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "E2", "]"}], ".", "epsp", ".", "epsp"}], 
        "]"}]}], "/.", "epsprule2"}], "/.", "epsprule1"}], "/.", 
    "epsrule"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5369487634414787`*^9, 3.5369488100481443`*^9}, {
   3.5369488943369656`*^9, 3.5369489014713736`*^9}, {3.536949133624652*^9, 
   3.536949140994074*^9}, {3.536951585376768*^9, 3.536951592646381*^9}, 
   3.537301741329111*^9, {3.5373019012662587`*^9, 3.5373019028413486`*^9}, 
   3.543244502227271*^9, 3.5432447490863905`*^9, {3.543245043350221*^9, 
   3.543245044749301*^9}, {3.5432453262013993`*^9, 3.5432453314847016`*^9}, 
   3.5432456069484572`*^9, {3.543245724396175*^9, 3.543245729471465*^9}, 
   3.543246052774957*^9, {3.5434220218898*^9, 3.5434220220338*^9}, {
   3.5435781082076607`*^9, 3.5435781083996716`*^9}, {3.54418778846472*^9, 
   3.5441877886487303`*^9}, {3.544188792842167*^9, 3.5441887930241776`*^9}, {
   3.5442791146195407`*^9, 3.5442791160976257`*^9}, 3.549712493047228*^9, {
   3.6430438100985355`*^9, 3.643043812008541*^9}, {3.6430440418653727`*^9, 
   3.6430440422543755`*^9}, {3.700499795838685*^9, 3.7004997999589205`*^9}, {
   3.7004999284392695`*^9, 
   3.7004999294783287`*^9}},ExpressionUUID->"3cb64d12-367a-4a72-9334-\
62f35dc15428"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving Linear System", "Subsection",
 CellChangeTimes->{{3.549712347193886*^9, 
  3.5497123502800627`*^9}},ExpressionUUID->"03b9093d-2f40-4d3d-a6e5-\
ce96987d9eb4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Variables", "[", "d3Fss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"NN", ",", "MM"}], "}"}], "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"d3Fss", ",", "vars"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"solution", ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"vars", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Inverse", "[", "MM", "]"}], ".", "NN"}]}], ")"}]}], 
       "]"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5369283351621113`*^9, 3.5369283655028467`*^9}, {
  3.53692840122289*^9, 3.536928477952279*^9}, {3.536928545021115*^9, 
  3.5369285908757377`*^9}, {3.5369289031856008`*^9, 3.536928948024165*^9}, {
  3.5434220240978003`*^9, 3.5434220242578*^9}, {3.5435781090947113`*^9, 
  3.543578109334725*^9}, {3.5441877912068768`*^9, 3.544187791366886*^9}, {
  3.544188795895342*^9, 3.5441887960943527`*^9}, {3.5442791171206837`*^9, 
  3.5442791192468057`*^9}, {3.694347114757768*^9, 
  3.694347116119137*^9}},ExpressionUUID->"e22bfcc1-346e-40b0-9a56-\
c54d75c408b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Saving Solution", "Subsection",
 CellChangeTimes->{{3.5360044033569756`*^9, 
  3.5360044090172997`*^9}},ExpressionUUID->"1474e050-31b5-4908-97d9-\
c61c7bf58113"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "ns"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G3", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"yvars", "/.", "funrulei"}], ",", 
           RowBox[{"{", 
            RowBox[{"state", ",", "3"}], "}"}]}], "]"}], "/.", "derivrule"}], 
        "/.", 
        RowBox[{"s", "\[Rule]", "ii"}]}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G3", "[", "ii", "]"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"G3", "[", "ii", "]"}], "]"}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"nx", "+", "ne", "+", "1"}], ")"}], "3"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H3", "[", "ii", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"xvars", "/.", "funrulei"}], ",", 
           RowBox[{"{", 
            RowBox[{"state", ",", "3"}], "}"}]}], "]"}], "/.", "derivrule"}], 
        "/.", 
        RowBox[{"s", "\[Rule]", "ii"}]}], "/.", "solution"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H3", "[", "ii", "]"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"H3", "[", "ii", "]"}], "]"}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"nx", "+", "ne", "+", "1"}], ")"}], "3"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"G3", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"H3", "[", "ii", "]"}], "]"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.536004455513959*^9, 3.536004467257631*^9}, {
   3.536004644196751*^9, 3.536004644668778*^9}, {3.536004787317937*^9, 
   3.536004857026924*^9}, {3.5360053244116573`*^9, 3.536005324971689*^9}, {
   3.536005462369548*^9, 3.536005577646141*^9}, 3.536005611583082*^9, {
   3.5360056512653522`*^9, 3.536005652295411*^9}, {3.536005708824644*^9, 
   3.536005738658351*^9}, {3.536005827619439*^9, 3.5360058838716564`*^9}, {
   3.536006084104109*^9, 3.536006088804378*^9}, {3.549712742721509*^9, 
   3.549712744719623*^9}, {3.61565529099061*^9, 3.615655292573701*^9}, {
   3.6401057315107813`*^9, 3.6401057347307887`*^9}, {3.643046654887161*^9, 
   3.643046686536207*^9}, {3.6430467430632906`*^9, 3.6430467447942934`*^9}, {
   3.6940164950434523`*^9, 3.6940164962115192`*^9}, {3.69434711952006*^9, 
   3.6943471385588865`*^9}},ExpressionUUID->"69ce2810-94d1-4506-823c-\
6d1d4cc82928"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Show Irrelevance of First and Second Order Results", "Section",
 CellChangeTimes->{{3.7387233943587303`*^9, 
  3.7387234077038856`*^9}},ExpressionUUID->"5a1848bb-dbb5-4ca3-b089-\
16dfb828819c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", "1", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", ";;"}], "]"}], "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", "state", "}"}], "]"}]}], "/.", 
   RowBox[{"\[Chi]", "\[Rule]", "1"}]}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.73382554799178*^9, 3.733825648651471*^9}, {
  3.7338256794126997`*^9, 3.7338256972697*^9}, {3.7338259780239973`*^9, 
  3.7338260153910885`*^9}},ExpressionUUID->"f4445991-581a-4a4c-8428-\
7242ce830c95"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H2", "[", "1", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", ";;"}], "]"}], "]"}], ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "state", "}"}], "]"}], ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "state", "}"}], "]"}]}], "]"}]}], "/.", 
   RowBox[{"\[Chi]", "\[Rule]", "1"}]}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.733825655896409*^9, 3.7338256754205155`*^9}, {
  3.7338257073334246`*^9, 3.7338257236774683`*^9}, {3.7338258619209385`*^9, 
  3.733825864090584*^9}, {3.7338260188638163`*^9, 
  3.733826020655032*^9}},ExpressionUUID->"0f8d7dd1-460b-4acf-b4bf-\
6e2b805c3a4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H3", "[", "1", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", ";;"}], "]"}], "]"}], ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "state", "}"}], "]"}], ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "state", "}"}], "]"}]}], "]"}], ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "state", "}"}], "]"}]}], "]"}]}], "/.", 
   RowBox[{"\[Chi]", "\[Rule]", "1"}]}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.7338257488346643`*^9, 3.733825816501276*^9}, {
  3.7338258685839186`*^9, 3.7338258708983774`*^9}, {3.7338260245804367`*^9, 
  3.7338260282698565`*^9}},ExpressionUUID->"9582c1df-bf65-482c-b7ed-\
9dccbe0da04d"]
}, Open  ]]
},
WindowSize->{1264, 661},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 67, "Section",ExpressionUUID->"122cb7c0-745c-4a64-a43f-94e07bffb9a2"],
Cell[CellGroupData[{
Cell[768, 29, 216, 4, 53, "Subsection",ExpressionUUID->"740a3a87-e734-407a-97bc-0392276c805d"],
Cell[987, 35, 729, 15, 67, "Input",ExpressionUUID->"aaf62a1a-ec72-443a-a17e-95e43c06500b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1753, 55, 156, 3, 53, "Subsection",ExpressionUUID->"81897418-8647-4ee1-a562-3c0f001b7362"],
Cell[1912, 60, 8173, 213, 366, "Input",ExpressionUUID->"806fc017-8f33-4fa1-8211-ba13b3892310"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10122, 278, 246, 4, 53, "Subsection",ExpressionUUID->"27136e79-c828-485c-9826-a8523c63a722"],
Cell[10371, 284, 7432, 150, 447, "Input",ExpressionUUID->"bb17bcfa-2ead-43f4-b17c-d68d414069cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17840, 439, 159, 3, 53, "Subsection",ExpressionUUID->"16a70ecc-910c-4ccd-a5b0-d8f01212bcd3"],
Cell[18002, 444, 5217, 120, 352, "Input",ExpressionUUID->"ed5e6aff-4a1f-4b9f-a3d0-ad9f5ceafe72"],
Cell[23222, 566, 1628, 42, 162, "Input",ExpressionUUID->"ab209a3f-25a7-4249-8328-01d6bacebe97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24887, 613, 236, 4, 53, "Subsection",ExpressionUUID->"0b914011-95c6-4c98-bf58-0252d674ad3f"],
Cell[25126, 619, 3377, 76, 154, "Input",ExpressionUUID->"897e032b-e1c5-4a17-a227-b5a37f85f555"],
Cell[28506, 697, 2730, 55, 86, "Input",ExpressionUUID->"f84d881c-f36a-4740-85e9-a61490788d02"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31285, 758, 161, 3, 67, "Section",ExpressionUUID->"796d0cbd-bdba-4f6b-990e-e12d16175788"],
Cell[CellGroupData[{
Cell[31471, 765, 160, 3, 53, "Subsection",ExpressionUUID->"0619cc58-1c1e-4bd4-aa12-9782b0f12646"],
Cell[31634, 770, 3355, 54, 413, "Input",ExpressionUUID->"3dbfc93e-032c-4073-916b-fbf92413f300"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35026, 829, 157, 3, 53, "Subsection",ExpressionUUID->"9ed7bf17-e6c4-4bbc-a56b-49f9651f8340"],
Cell[35186, 834, 2094, 55, 148, "Input",ExpressionUUID->"e145df58-fa44-4d91-8d65-96868f17b9eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37317, 894, 217, 4, 53, "Subsection",ExpressionUUID->"1b9fa631-7685-45dc-9432-3ec1731925bf"],
Cell[37537, 900, 2080, 61, 220, "Input",ExpressionUUID->"5c2f4fc9-ef75-4977-b8d6-3d1602bf9208"],
Cell[39620, 963, 432, 11, 48, "Input",ExpressionUUID->"2d903dd3-995a-4bc1-9b86-1e218e620404"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40089, 979, 171, 3, 53, "Subsection",ExpressionUUID->"3c7dfec6-41aa-4f4e-b0bf-99af4861fb17"],
Cell[40263, 984, 959, 25, 67, "Input",ExpressionUUID->"78d591f9-e445-4e3a-888d-13e2102fe4d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41259, 1014, 204, 4, 53, "Subsection",ExpressionUUID->"24a41a51-d9ad-4f6d-8d8a-78de21934b46"],
Cell[41466, 1020, 647, 18, 48, "Input",ExpressionUUID->"ea34e48e-d33e-483c-b244-7a0ed4c59f50"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42162, 1044, 172, 3, 67, "Section",ExpressionUUID->"3579105a-59d2-49a6-98fe-4d7516660439"],
Cell[CellGroupData[{
Cell[42359, 1051, 160, 3, 53, "Subsection",ExpressionUUID->"18db7b3b-edb5-4e0f-b487-faa0a03f1f87"],
Cell[42522, 1056, 1198, 30, 86, "Input",ExpressionUUID->"de2f8f75-6b43-4a5f-b5ab-3587a2e9c7c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43757, 1091, 168, 3, 53, "Subsection",ExpressionUUID->"522bf290-b69f-46af-965d-331c71f8b24a"],
Cell[43928, 1096, 1835, 40, 67, "Input",ExpressionUUID->"ee903fb2-3fcc-45bc-882d-45dda8741755"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45800, 1141, 163, 3, 53, "Subsection",ExpressionUUID->"73f5bd09-c370-4ab9-a130-dc6647ecc365"],
Cell[45966, 1146, 4520, 128, 411, "Input",ExpressionUUID->"5a4e2d4c-d8d3-4e20-a0b6-18f3966508cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50523, 1279, 252, 4, 53, "Subsection",ExpressionUUID->"68bf6d6c-2c31-4e85-9f3e-8fc7bf080a87"],
Cell[50778, 1285, 992, 26, 48, "Input",ExpressionUUID->"6e711b7a-5c2d-4a45-a95e-16aff609dfdf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51807, 1316, 226, 4, 53, "Subsection",ExpressionUUID->"bcb74071-d191-4463-bfb1-28f05b1e5115"],
Cell[52036, 1322, 1078, 29, 48, "Input",ExpressionUUID->"63b98d0c-c2c5-4409-ac55-9502172c8f33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53151, 1356, 162, 3, 53, "Subsection",ExpressionUUID->"414b568e-ed65-4872-8981-ef2ac476e885"],
Cell[53316, 1361, 836, 21, 28, "Input",ExpressionUUID->"8b86a9ae-ac52-42cc-941d-2f5ff1c3604f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54189, 1387, 160, 3, 53, "Subsection",ExpressionUUID->"36cc6f69-9ce9-4b9a-848a-a7f7f4980f90"],
Cell[54352, 1392, 1311, 32, 124, "Input",ExpressionUUID->"cfd04a85-ff53-45c8-9a68-19b8d60d4d78"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55712, 1430, 174, 3, 67, "Section",ExpressionUUID->"c5226f17-ed32-4c47-b383-3ceb3ffd008e"],
Cell[CellGroupData[{
Cell[55911, 1437, 219, 4, 53, "Subsection",ExpressionUUID->"14f13d70-df17-419e-8594-8803c8fe353e"],
Cell[56133, 1443, 2784, 59, 124, "Input",ExpressionUUID->"1dfec160-e070-4188-ab63-5dd1f7fc09c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58954, 1507, 181, 3, 53, "Subsection",ExpressionUUID->"0a6b2ea4-feb4-4c40-b54d-6d7a52225d8e"],
Cell[59138, 1512, 1586, 32, 48, "Input",ExpressionUUID->"70e4107a-a9cd-4572-a2b7-e37fcd7b1950"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60761, 1549, 171, 3, 53, "Subsection",ExpressionUUID->"c7014206-e2cc-4aa5-a082-2f52592a9955"],
Cell[60935, 1554, 1237, 29, 67, "Input",ExpressionUUID->"ba63c3fd-1541-4ccb-8c26-58163ab8dbf4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62209, 1588, 166, 3, 53, "Subsection",ExpressionUUID->"ccc72439-dfe4-432d-9785-da5299c28913"],
Cell[62378, 1593, 1124, 27, 28, "Input",ExpressionUUID->"393632c3-0b26-4449-96d1-6c38a7866887"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63539, 1625, 167, 3, 53, "Subsection",ExpressionUUID->"f1039c50-b760-4733-9517-bbaff9cfa20f"],
Cell[63709, 1630, 3067, 76, 180, "Input",ExpressionUUID->"2c81fe3a-4e2b-4b3c-98ce-0a16c8273a27"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66825, 1712, 224, 4, 67, "Section",ExpressionUUID->"05b766e8-a1ff-4a89-9ba2-151950a8814c"],
Cell[CellGroupData[{
Cell[67074, 1720, 219, 4, 53, "Subsection",ExpressionUUID->"95a418f5-8658-4b13-80fe-7175fd4572f1"],
Cell[67296, 1726, 3381, 71, 162, "Input",ExpressionUUID->"0c155c32-c907-459a-8929-9ac8cbc3c9a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70714, 1802, 181, 3, 53, "Subsection",ExpressionUUID->"ea91209d-0869-4373-9634-180db17bfc61"],
Cell[70898, 1807, 1681, 34, 48, "Input",ExpressionUUID->"3cb64d12-367a-4a72-9334-62f35dc15428"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72616, 1846, 171, 3, 53, "Subsection",ExpressionUUID->"03b9093d-2f40-4d3d-a6e5-ce96987d9eb4"],
Cell[72790, 1851, 1264, 30, 67, "Input",ExpressionUUID->"e22bfcc1-346e-40b0-9a56-c54d75c408b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74091, 1886, 167, 3, 53, "Subsection",ExpressionUUID->"1474e050-31b5-4908-97d9-c61c7bf58113"],
Cell[74261, 1891, 3050, 76, 180, "Input",ExpressionUUID->"69ce2810-94d1-4506-823c-6d1d4cc82928"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77360, 1973, 199, 3, 67, "Section",ExpressionUUID->"5a1848bb-dbb5-4ca3-b089-16dfb828819c"],
Cell[77562, 1978, 543, 14, 28, "Input",ExpressionUUID->"f4445991-581a-4a4c-8428-7242ce830c95"],
Cell[78108, 1994, 747, 19, 28, "Input",ExpressionUUID->"0f8d7dd1-460b-4acf-b4bf-6e2b805c3a4a"],
Cell[78858, 2015, 853, 22, 28, "Input",ExpressionUUID->"9582c1df-bf65-482c-b7ed-9dccbe0da04d"]
}, Open  ]]
}
]
*)

